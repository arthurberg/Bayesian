<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>14 Class 14: Hierarchical Models | PHS 528: Bayesian Methods</title>
<meta name="author" content="Arthur Berg">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="14 Class 14: Hierarchical Models | PHS 528: Bayesian Methods">
<meta property="og:type" content="book">
<meta property="og:url" content="https://arthurberg.github.io/Bayesian/class-14-hierarchical-models.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="14 Class 14: Hierarchical Models | PHS 528: Bayesian Methods">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="14.1 Example 1: Bristol babies  Example 14.1 (Bristol babies) The [Bristol heart scandal](https://en.wikipedia.org/wiki/Bristol_heart_scandal came about after it was discovered that babies were...">
<meta property="og:description" content="14.1 Example 1: Bristol babies  Example 14.1 (Bristol babies) The [Bristol heart scandal](https://en.wikipedia.org/wiki/Bristol_heart_scandal came about after it was discovered that babies were...">
<meta name="twitter:description" content="14.1 Example 1: Bristol babies  Example 14.1 (Bristol babies) The [Bristol heart scandal](https://en.wikipedia.org/wiki/Bristol_heart_scandal came about after it was discovered that babies were...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PHS 528: Bayesian Methods</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Class 1: Probability Fundamentals &amp; Monte Carlo</a></li>
<li><a class="" href="class-2-diagnostic-testing.html"><span class="header-section-number">2</span> Class 2: Diagnostic Testing</a></li>
<li><a class="" href="class-3-bayes-theorem-practice.html"><span class="header-section-number">3</span> Class 3: Bayes’ Theorem Practice</a></li>
<li><a class="" href="class-4-beta-binomial.html"><span class="header-section-number">4</span> Class 4: Beta-binomial</a></li>
<li><a class="" href="class-5-covid-19-vaccine-trials-bayesian-dice.html"><span class="header-section-number">5</span> Class 5: COVID-19 Vaccine Trials &amp; Bayesian Dice</a></li>
<li><a class="" href="class-6-stick-breaking.html"><span class="header-section-number">6</span> Class 6: Stick Breaking</a></li>
<li><a class="" href="class-7-taxicab-problem.html"><span class="header-section-number">7</span> Class 7: Taxicab problem</a></li>
<li><a class="" href="class-8-bayesian-shrinkage.html"><span class="header-section-number">8</span> Class 8: Bayesian shrinkage</a></li>
<li><a class="" href="class-9-bayes-estimator.html"><span class="header-section-number">9</span> Class 9: Bayes estimator</a></li>
<li><a class="" href="class-10-minimax.html"><span class="header-section-number">10</span> Class 10: Minimax</a></li>
<li><a class="" href="class-11-prior-distributions.html"><span class="header-section-number">11</span> Class 11: Prior distributions</a></li>
<li><a class="" href="class-12-information-theory.html"><span class="header-section-number">12</span> Class 12: Information Theory</a></li>
<li><a class="" href="class-13-information-theory-cont.html"><span class="header-section-number">13</span> Class 13: Information Theory (cont)</a></li>
<li><a class="active" href="class-14-hierarchical-models.html"><span class="header-section-number">14</span> Class 14: Hierarchical Models</a></li>
<li><a class="" href="to-be-incorporated.html"><span class="header-section-number">15</span> To Be Incorporated</a></li>
<li><a class="" href="references.html"><span class="header-section-number">16</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/arthurberg/Bayesian">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="class-14-hierarchical-models" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Class 14: Hierarchical Models<a class="anchor" aria-label="anchor" href="#class-14-hierarchical-models"><i class="fas fa-link"></i></a>
</h1>
<div id="example-1-bristol-babies" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Example 1: Bristol babies<a class="anchor" aria-label="anchor" href="#example-1-bristol-babies"><i class="fas fa-link"></i></a>
</h2>
<div class="example lizi">
<p><span id="exm:bristol-babies" class="example"><strong>Example 14.1  (Bristol babies) </strong></span>The [Bristol heart scandal](<a href="https://en.wikipedia.org/wiki/Bristol_heart_scandal" class="uri">https://en.wikipedia.org/wiki/Bristol_heart_scandal</a> came about after it was discovered that babies were dying at high rates after cardiac surgery when treated at the <a href="https://en.wikipedia.org/wiki/Bristol_Royal_Infirmary">Bristol Royal Infirmary</a>. The comprehensive report<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Ian Kennedy et al., &lt;span&gt;“The Bristol Royal Infirmary Inquiry: The Report of the Public Inquiry into Children’s Heart Surgery at the Bristol Royal Infirmary 1984-1995”&lt;/span&gt; (Presented to Parliament by the Secretary of State for Health by Command of Her Majesty, 2001), &lt;a href="http://www.wales.nhs.uk/sites3/documents/441/The%20Kennedy%20Report.pdf" role="doc-biblioref"&gt;http://www.wales.nhs.uk/sites3/documents/441/The%20Kennedy%20Report.pdf&lt;/a&gt;.&lt;/p&gt;'><sup>7</sup></a></span> subsequently led to substantial changes in health service monitoring in the UK. Data from this incident was statistically analyzed in<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;David J Spiegelhalter et al., &lt;span&gt;“Commissioned Analysis of Surgical Performance Using Routine Data: Lessons from the Bristol Inquiry,”&lt;/span&gt; &lt;em&gt;Journal of the Royal Statistical Society: Series A (Statistics in Society)&lt;/em&gt; 165, no. 2 (2002): 191–221, &lt;a href="https://doi-org.ezaccess.libraries.psu.edu/10.1111/1467-985X.02021" role="doc-biblioref"&gt;https://doi-org.ezaccess.libraries.psu.edu/10.1111/1467-985X.02021&lt;/a&gt;.&lt;/p&gt;'><sup>8</sup></a></span> and,<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;EC Marshall and DJ Spiegelhalter, &lt;span&gt;“Identifying Outliers in &lt;span&gt;B&lt;/span&gt;ayesian Hierarchical Models: A Simulation-Based Approach,”&lt;/span&gt; &lt;em&gt;Bayesian Analysis&lt;/em&gt; 2, no. 2 (2007): 409–44, &lt;a href="http://projecteuclid.org/download/pdf_1/euclid.ba/1340393242" role="doc-biblioref"&gt;http://projecteuclid.org/download/pdf_1/euclid.ba/1340393242&lt;/a&gt;.&lt;/p&gt;'><sup>9</sup></a></span> and includes the table below. The following models are fit:</p>
<ul>
<li>constant-risk model
<span class="math display">\[
\begin{split}
X_i&amp;\sim\text{Binomial}(n_i,\theta)\\
\theta&amp;\sim\text{Uniform}(0,1)
\end{split}
\]</span>
</li>
<li>independent parameters model
<span class="math display">\[
\begin{split}
X_i&amp;\sim\text{Binomial}(n_i,\theta_i)\\
\theta_i&amp;\sim\text{Uniform}(0,1)
\end{split}
\]</span>
</li>
<li>hierarchical model
<span class="math display">\[
\begin{split}
X_i&amp;\sim\text{Binomial}(n_i,\theta_i)\\
\text{logit_i}(\theta)&amp;\sim \mathcal{N}(\mu,\sigma^2)\\
\mu&amp;\sim\text{Uniform}(-100,100)\\
1/\sigma^2&amp;\sim\text{Uniform}(0,100)
\end{split}
\]</span>
Residual analysis of the constant-risk model shows a poor model selection. Shrinkage is observed for the parameters in the hierarchical model.</li>
</ul>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="va">bristol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>hospital <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bristol"</span>, <span class="st">"Leicester"</span>, <span class="st">"Leeds"</span>,</span>
<span>    <span class="st">"Oxford"</span>, <span class="st">"Guys"</span>, <span class="st">"Liverpool"</span>, <span class="st">"Southampton"</span>, <span class="st">"Great Ormond St"</span>,</span>
<span>    <span class="st">"Newcastle"</span>, <span class="st">"Harefield"</span>, <span class="st">"Birmingham"</span>, <span class="st">"Brompton"</span><span class="op">)</span>, operations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">143</span>,</span>
<span>    <span class="fl">187</span>, <span class="fl">323</span>, <span class="fl">122</span>, <span class="fl">164</span>, <span class="fl">405</span>, <span class="fl">239</span>, <span class="fl">482</span>, <span class="fl">195</span>, <span class="fl">177</span>, <span class="fl">581</span>, <span class="fl">301</span><span class="op">)</span>, deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">41</span>,</span>
<span>    <span class="fl">25</span>, <span class="fl">24</span>, <span class="fl">23</span>, <span class="fl">25</span>, <span class="fl">42</span>, <span class="fl">24</span>, <span class="fl">53</span>, <span class="fl">26</span>, <span class="fl">25</span>, <span class="fl">58</span>, <span class="fl">31</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mortality <span class="op">=</span> <span class="va">deaths</span><span class="op">/</span><span class="va">operations</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">mortality</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># xtable(bristol,digits=c(0,0,0,0,2))</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="va">bristol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic_2</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
hospital
</th>
<th style="text-align:right;">
operations
</th>
<th style="text-align:right;">
deaths
</th>
<th style="text-align:right;">
mortality
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Bristol
</td>
<td style="text-align:right;">
143
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
0.2867133
</td>
</tr>
<tr>
<td style="text-align:left;">
Oxford
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0.1885246
</td>
</tr>
<tr>
<td style="text-align:left;">
Guys
</td>
<td style="text-align:right;">
164
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.1524390
</td>
</tr>
<tr>
<td style="text-align:left;">
Harefield
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.1412429
</td>
</tr>
<tr>
<td style="text-align:left;">
Leicester
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0.1336898
</td>
</tr>
<tr>
<td style="text-align:left;">
Newcastle
</td>
<td style="text-align:right;">
195
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
0.1333333
</td>
</tr>
<tr>
<td style="text-align:left;">
Great Ormond St
</td>
<td style="text-align:right;">
482
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
0.1099585
</td>
</tr>
<tr>
<td style="text-align:left;">
Liverpool
</td>
<td style="text-align:right;">
405
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
0.1037037
</td>
</tr>
<tr>
<td style="text-align:left;">
Brompton
</td>
<td style="text-align:right;">
301
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
0.1029900
</td>
</tr>
<tr>
<td style="text-align:left;">
Southampton
</td>
<td style="text-align:right;">
239
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.1004184
</td>
</tr>
<tr>
<td style="text-align:left;">
Birmingham
</td>
<td style="text-align:right;">
581
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
0.0998279
</td>
</tr>
<tr>
<td style="text-align:left;">
Leeds
</td>
<td style="text-align:right;">
323
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.0743034
</td>
</tr>
</tbody>
</table></div>
<div id="constant-risk-model" class="section level3" number="14.1.1">
<h3>
<span class="header-section-number">14.1.1</span> Constant-risk model<a class="anchor" aria-label="anchor" href="#constant-risk-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="class-14-hierarchical-models.html#cb34-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb34-2"><a href="class-14-hierarchical-models.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="class-14-hierarchical-models.html#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Likelihood</span></span>
<span id="cb34-4"><a href="class-14-hierarchical-models.html#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb34-5"><a href="class-14-hierarchical-models.html#cb34-5" aria-hidden="true" tabindex="-1"></a>        y[i] <span class="sc">~</span> <span class="fu">dbin</span>(theta, n[i])</span>
<span id="cb34-6"><a href="class-14-hierarchical-models.html#cb34-6" aria-hidden="true" tabindex="-1"></a>        res[i] <span class="ot">&lt;-</span> (y[i] <span class="sc">-</span> n[i] <span class="sc">*</span> theta)<span class="sc">/</span><span class="fu">sqrt</span>(n[i] <span class="sc">*</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span></span>
<span id="cb34-7"><a href="class-14-hierarchical-models.html#cb34-7" aria-hidden="true" tabindex="-1"></a>            theta))</span>
<span id="cb34-8"><a href="class-14-hierarchical-models.html#cb34-8" aria-hidden="true" tabindex="-1"></a>        res2[i] <span class="ot">&lt;-</span> res[i] <span class="sc">*</span> res[i]</span>
<span id="cb34-9"><a href="class-14-hierarchical-models.html#cb34-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-10"><a href="class-14-hierarchical-models.html#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="class-14-hierarchical-models.html#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="do">## prior</span></span>
<span id="cb34-12"><a href="class-14-hierarchical-models.html#cb34-12" aria-hidden="true" tabindex="-1"></a>    theta <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-13"><a href="class-14-hierarchical-models.html#cb34-13" aria-hidden="true" tabindex="-1"></a>    X2.obs <span class="ot">&lt;-</span> <span class="fu">sum</span>(res2[])</span>
<span id="cb34-14"><a href="class-14-hierarchical-models.html#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="class-14-hierarchical-models.html#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="class-14-hierarchical-models.html#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="class-14-hierarchical-models.html#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="class-14-hierarchical-models.html#cb34-18" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">n =</span> bristol<span class="sc">$</span>operations, <span class="at">y =</span> bristol<span class="sc">$</span>deaths)</span>
<span id="cb34-19"><a href="class-14-hierarchical-models.html#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="class-14-hierarchical-models.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb34-21"><a href="class-14-hierarchical-models.html#cb34-21" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> data, <span class="at">model =</span> model, <span class="at">parameters.to.save =</span> <span class="fu">c</span>(<span class="st">"theta"</span>,</span>
<span id="cb34-22"><a href="class-14-hierarchical-models.html#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"res"</span>, <span class="st">"X2.obs"</span>), <span class="at">n.chain =</span> <span class="dv">2</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>, <span class="at">n.thin =</span> <span class="dv">1</span>,</span>
<span id="cb34-23"><a href="class-14-hierarchical-models.html#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.burn =</span> <span class="dv">100</span>, <span class="at">DIC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-24"><a href="class-14-hierarchical-models.html#cb34-24" aria-hidden="true" tabindex="-1"></a>module glm loaded</span>
<span id="cb34-25"><a href="class-14-hierarchical-models.html#cb34-25" aria-hidden="true" tabindex="-1"></a>module dic loaded</span>
<span id="cb34-26"><a href="class-14-hierarchical-models.html#cb34-26" aria-hidden="true" tabindex="-1"></a>Compiling model graph</span>
<span id="cb34-27"><a href="class-14-hierarchical-models.html#cb34-27" aria-hidden="true" tabindex="-1"></a>   Resolving undeclared variables</span>
<span id="cb34-28"><a href="class-14-hierarchical-models.html#cb34-28" aria-hidden="true" tabindex="-1"></a>   Allocating nodes</span>
<span id="cb34-29"><a href="class-14-hierarchical-models.html#cb34-29" aria-hidden="true" tabindex="-1"></a>Graph information<span class="sc">:</span></span>
<span id="cb34-30"><a href="class-14-hierarchical-models.html#cb34-30" aria-hidden="true" tabindex="-1"></a>   Observed stochastic nodes<span class="sc">:</span> <span class="dv">12</span></span>
<span id="cb34-31"><a href="class-14-hierarchical-models.html#cb34-31" aria-hidden="true" tabindex="-1"></a>   Unobserved stochastic nodes<span class="sc">:</span> <span class="dv">1</span></span>
<span id="cb34-32"><a href="class-14-hierarchical-models.html#cb34-32" aria-hidden="true" tabindex="-1"></a>   Total graph size<span class="sc">:</span> <span class="dv">102</span></span>
<span id="cb34-33"><a href="class-14-hierarchical-models.html#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="class-14-hierarchical-models.html#cb34-34" aria-hidden="true" tabindex="-1"></a>Initializing model</span>
<span id="cb34-35"><a href="class-14-hierarchical-models.html#cb34-35" aria-hidden="true" tabindex="-1"></a>fit.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(fit)</span>
<span id="cb34-36"><a href="class-14-hierarchical-models.html#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mcmc)</span>
<span id="cb34-37"><a href="class-14-hierarchical-models.html#cb34-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-38"><a href="class-14-hierarchical-models.html#cb34-38" aria-hidden="true" tabindex="-1"></a>Iterations <span class="ot">=</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb34-39"><a href="class-14-hierarchical-models.html#cb34-39" aria-hidden="true" tabindex="-1"></a>Thinning interval <span class="ot">=</span> <span class="dv">1</span> </span>
<span id="cb34-40"><a href="class-14-hierarchical-models.html#cb34-40" aria-hidden="true" tabindex="-1"></a>Number of chains <span class="ot">=</span> <span class="dv">2</span> </span>
<span id="cb34-41"><a href="class-14-hierarchical-models.html#cb34-41" aria-hidden="true" tabindex="-1"></a>Sample size per chain <span class="ot">=</span> <span class="dv">4900</span> </span>
<span id="cb34-42"><a href="class-14-hierarchical-models.html#cb34-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-43"><a href="class-14-hierarchical-models.html#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> Empirical mean and standard deviation <span class="cf">for</span> each variable,</span>
<span id="cb34-44"><a href="class-14-hierarchical-models.html#cb34-44" aria-hidden="true" tabindex="-1"></a>   plus standard error of the mean<span class="sc">:</span></span>
<span id="cb34-45"><a href="class-14-hierarchical-models.html#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="class-14-hierarchical-models.html#cb34-46" aria-hidden="true" tabindex="-1"></a>           Mean       SD  Naive SE Time<span class="sc">-</span>series SE</span>
<span id="cb34-47"><a href="class-14-hierarchical-models.html#cb34-47" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">1</span>]   <span class="fl">6.1499</span> <span class="fl">0.329142</span> <span class="fl">0.0033248</span>      <span class="fl">4.275e-03</span></span>
<span id="cb34-48"><a href="class-14-hierarchical-models.html#cb34-48" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">10</span>] <span class="sc">-</span><span class="fl">0.9222</span> <span class="fl">0.246955</span> <span class="fl">0.0024946</span>      <span class="fl">3.209e-03</span></span>
<span id="cb34-49"><a href="class-14-hierarchical-models.html#cb34-49" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">11</span>] <span class="sc">-</span><span class="fl">1.4817</span> <span class="fl">0.384158</span> <span class="fl">0.0038806</span>      <span class="fl">4.992e-03</span></span>
<span id="cb34-50"><a href="class-14-hierarchical-models.html#cb34-50" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">12</span>] <span class="sc">-</span><span class="fl">2.5181</span> <span class="fl">0.257998</span> <span class="fl">0.0026062</span>      <span class="fl">3.353e-03</span></span>
<span id="cb34-51"><a href="class-14-hierarchical-models.html#cb34-51" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">2</span>]   <span class="fl">2.3392</span> <span class="fl">0.236772</span> <span class="fl">0.0023918</span>      <span class="fl">3.076e-03</span></span>
<span id="cb34-52"><a href="class-14-hierarchical-models.html#cb34-52" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">3</span>]   <span class="fl">1.2884</span> <span class="fl">0.245869</span> <span class="fl">0.0024836</span>      <span class="fl">3.194e-03</span></span>
<span id="cb34-53"><a href="class-14-hierarchical-models.html#cb34-53" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">4</span>]   <span class="fl">0.8796</span> <span class="fl">0.246193</span> <span class="fl">0.0024869</span>      <span class="fl">3.199e-03</span></span>
<span id="cb34-54"><a href="class-14-hierarchical-models.html#cb34-54" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">5</span>]   <span class="fl">0.5859</span> <span class="fl">0.246649</span> <span class="fl">0.0024915</span>      <span class="fl">3.205e-03</span></span>
<span id="cb34-55"><a href="class-14-hierarchical-models.html#cb34-55" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">6</span>]   <span class="fl">0.5830</span> <span class="fl">0.251561</span> <span class="fl">0.0025411</span>      <span class="fl">3.268e-03</span></span>
<span id="cb34-56"><a href="class-14-hierarchical-models.html#cb34-56" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">7</span>]  <span class="sc">-</span><span class="fl">0.6644</span> <span class="fl">0.363689</span> <span class="fl">0.0036738</span>      <span class="fl">4.726e-03</span></span>
<span id="cb34-57"><a href="class-14-hierarchical-models.html#cb34-57" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">8</span>]  <span class="sc">-</span><span class="fl">0.9968</span> <span class="fl">0.325572</span> <span class="fl">0.0032888</span>      <span class="fl">4.230e-03</span></span>
<span id="cb34-58"><a href="class-14-hierarchical-models.html#cb34-58" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">9</span>]  <span class="sc">-</span><span class="fl">0.8975</span> <span class="fl">0.279907</span> <span class="fl">0.0028275</span>      <span class="fl">3.637e-03</span></span>
<span id="cb34-59"><a href="class-14-hierarchical-models.html#cb34-59" aria-hidden="true" tabindex="-1"></a>theta    <span class="fl">0.1199</span> <span class="fl">0.005574</span> <span class="fl">0.0000563</span>      <span class="fl">7.253e-05</span></span>
<span id="cb34-60"><a href="class-14-hierarchical-models.html#cb34-60" aria-hidden="true" tabindex="-1"></a>X2.obs  <span class="fl">59.0388</span> <span class="fl">2.764042</span> <span class="fl">0.0279210</span>      <span class="fl">3.679e-02</span></span>
<span id="cb34-61"><a href="class-14-hierarchical-models.html#cb34-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-62"><a href="class-14-hierarchical-models.html#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Quantiles <span class="cf">for</span> each variable<span class="sc">:</span></span>
<span id="cb34-63"><a href="class-14-hierarchical-models.html#cb34-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-64"><a href="class-14-hierarchical-models.html#cb34-64" aria-hidden="true" tabindex="-1"></a>           <span class="fl">2.5</span><span class="sc">%     25%</span>     <span class="dv">50</span><span class="sc">%     75%</span>    <span class="fl">97.5</span>%</span>
<span id="cb34-65"><a href="class-14-hierarchical-models.html#cb34-65" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">1</span>]   <span class="fl">5.5309</span>  <span class="fl">5.9250</span>  <span class="fl">6.1440</span>  <span class="fl">6.3703</span>  <span class="fl">6.80791</span></span>
<span id="cb34-66"><a href="class-14-hierarchical-models.html#cb34-66" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">10</span>] <span class="sc">-</span><span class="fl">1.3919</span> <span class="sc">-</span><span class="fl">1.0900</span> <span class="sc">-</span><span class="fl">0.9248</span> <span class="sc">-</span><span class="fl">0.7557</span> <span class="sc">-</span><span class="fl">0.43395</span></span>
<span id="cb34-67"><a href="class-14-hierarchical-models.html#cb34-67" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">11</span>] <span class="sc">-</span><span class="fl">2.2125</span> <span class="sc">-</span><span class="fl">1.7428</span> <span class="sc">-</span><span class="fl">1.4857</span> <span class="sc">-</span><span class="fl">1.2227</span> <span class="sc">-</span><span class="fl">0.72224</span></span>
<span id="cb34-68"><a href="class-14-hierarchical-models.html#cb34-68" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">12</span>] <span class="sc">-</span><span class="fl">3.0102</span> <span class="sc">-</span><span class="fl">2.6931</span> <span class="sc">-</span><span class="fl">2.5202</span> <span class="sc">-</span><span class="fl">2.3438</span> <span class="sc">-</span><span class="fl">2.00949</span></span>
<span id="cb34-69"><a href="class-14-hierarchical-models.html#cb34-69" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">2</span>]   <span class="fl">1.8919</span>  <span class="fl">2.1778</span>  <span class="fl">2.3357</span>  <span class="fl">2.4982</span>  <span class="fl">2.81052</span></span>
<span id="cb34-70"><a href="class-14-hierarchical-models.html#cb34-70" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">3</span>]   <span class="fl">0.8229</span>  <span class="fl">1.1210</span>  <span class="fl">1.2852</span>  <span class="fl">1.4537</span>  <span class="fl">1.77674</span></span>
<span id="cb34-71"><a href="class-14-hierarchical-models.html#cb34-71" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">4</span>]   <span class="fl">0.4131</span>  <span class="fl">0.7120</span>  <span class="fl">0.8765</span>  <span class="fl">1.0452</span>  <span class="fl">1.36818</span></span>
<span id="cb34-72"><a href="class-14-hierarchical-models.html#cb34-72" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">5</span>]   <span class="fl">0.1182</span>  <span class="fl">0.4181</span>  <span class="fl">0.5829</span>  <span class="fl">0.7519</span>  <span class="fl">1.07509</span></span>
<span id="cb34-73"><a href="class-14-hierarchical-models.html#cb34-73" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">6</span>]   <span class="fl">0.1060</span>  <span class="fl">0.4118</span>  <span class="fl">0.5799</span>  <span class="fl">0.7523</span>  <span class="fl">1.08189</span></span>
<span id="cb34-74"><a href="class-14-hierarchical-models.html#cb34-74" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">7</span>]  <span class="sc">-</span><span class="fl">1.3555</span> <span class="sc">-</span><span class="fl">0.9116</span> <span class="sc">-</span><span class="fl">0.6684</span> <span class="sc">-</span><span class="fl">0.4194</span>  <span class="fl">0.05536</span></span>
<span id="cb34-75"><a href="class-14-hierarchical-models.html#cb34-75" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">8</span>]  <span class="sc">-</span><span class="fl">1.6159</span> <span class="sc">-</span><span class="fl">1.2181</span> <span class="sc">-</span><span class="fl">1.0002</span> <span class="sc">-</span><span class="fl">0.7774</span> <span class="sc">-</span><span class="fl">0.35289</span></span>
<span id="cb34-76"><a href="class-14-hierarchical-models.html#cb34-76" aria-hidden="true" tabindex="-1"></a>res[<span class="dv">9</span>]  <span class="sc">-</span><span class="fl">1.4298</span> <span class="sc">-</span><span class="fl">1.0877</span> <span class="sc">-</span><span class="fl">0.9004</span> <span class="sc">-</span><span class="fl">0.7088</span> <span class="sc">-</span><span class="fl">0.34393</span></span>
<span id="cb34-77"><a href="class-14-hierarchical-models.html#cb34-77" aria-hidden="true" tabindex="-1"></a>theta    <span class="fl">0.1092</span>  <span class="fl">0.1161</span>  <span class="fl">0.1198</span>  <span class="fl">0.1236</span>  <span class="fl">0.13077</span></span>
<span id="cb34-78"><a href="class-14-hierarchical-models.html#cb34-78" aria-hidden="true" tabindex="-1"></a>X2.obs  <span class="fl">56.7590</span> <span class="fl">57.0736</span> <span class="fl">58.0523</span> <span class="fl">60.0141</span> <span class="fl">66.59561</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html">as.mcmc</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta.avg</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span>,<span class="st">"theta"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">mat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"res["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-3-1.png" width="960"></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mc-stan.org/bayesplot/">"bayesplot"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="va">plot_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Posterior distributions  of residuals"</span>,</span>
<span>                      <span class="st">"with medians and 95% intervals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>           pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"res["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span>,</span>
<span>           prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> <span class="va">plot_title</span></span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-3-2.png" width="960"></div>
</div>
<div id="independent-parameters-model" class="section level3" number="14.1.2">
<h3>
<span class="header-section-number">14.1.2</span> Independent-parameters model<a class="anchor" aria-label="anchor" href="#independent-parameters-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="class-14-hierarchical-models.html#cb37-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb37-2"><a href="class-14-hierarchical-models.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="class-14-hierarchical-models.html#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Likelihood</span></span>
<span id="cb37-4"><a href="class-14-hierarchical-models.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb37-5"><a href="class-14-hierarchical-models.html#cb37-5" aria-hidden="true" tabindex="-1"></a>        y[i] <span class="sc">~</span> <span class="fu">dbin</span>(theta[i], n[i])</span>
<span id="cb37-6"><a href="class-14-hierarchical-models.html#cb37-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-7"><a href="class-14-hierarchical-models.html#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="class-14-hierarchical-models.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## priors</span></span>
<span id="cb37-9"><a href="class-14-hierarchical-models.html#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb37-10"><a href="class-14-hierarchical-models.html#cb37-10" aria-hidden="true" tabindex="-1"></a>        theta[i] <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb37-11"><a href="class-14-hierarchical-models.html#cb37-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-12"><a href="class-14-hierarchical-models.html#cb37-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="class-14-hierarchical-models.html#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="class-14-hierarchical-models.html#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="class-14-hierarchical-models.html#cb37-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">n =</span> bristol<span class="sc">$</span>operations, <span class="at">y =</span> bristol<span class="sc">$</span>deaths)</span>
<span id="cb37-16"><a href="class-14-hierarchical-models.html#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="class-14-hierarchical-models.html#cb37-17" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> data, <span class="at">model =</span> model, <span class="at">parameters.to.save =</span> <span class="fu">c</span>(<span class="st">"theta"</span>),</span>
<span id="cb37-18"><a href="class-14-hierarchical-models.html#cb37-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.chain =</span> <span class="dv">2</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>, <span class="at">n.thin =</span> <span class="dv">1</span>, <span class="at">n.burn =</span> <span class="dv">100</span>, <span class="at">DIC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-19"><a href="class-14-hierarchical-models.html#cb37-19" aria-hidden="true" tabindex="-1"></a>Compiling model graph</span>
<span id="cb37-20"><a href="class-14-hierarchical-models.html#cb37-20" aria-hidden="true" tabindex="-1"></a>   Resolving undeclared variables</span>
<span id="cb37-21"><a href="class-14-hierarchical-models.html#cb37-21" aria-hidden="true" tabindex="-1"></a>   Allocating nodes</span>
<span id="cb37-22"><a href="class-14-hierarchical-models.html#cb37-22" aria-hidden="true" tabindex="-1"></a>Graph information<span class="sc">:</span></span>
<span id="cb37-23"><a href="class-14-hierarchical-models.html#cb37-23" aria-hidden="true" tabindex="-1"></a>   Observed stochastic nodes<span class="sc">:</span> <span class="dv">12</span></span>
<span id="cb37-24"><a href="class-14-hierarchical-models.html#cb37-24" aria-hidden="true" tabindex="-1"></a>   Unobserved stochastic nodes<span class="sc">:</span> <span class="dv">12</span></span>
<span id="cb37-25"><a href="class-14-hierarchical-models.html#cb37-25" aria-hidden="true" tabindex="-1"></a>   Total graph size<span class="sc">:</span> <span class="dv">38</span></span>
<span id="cb37-26"><a href="class-14-hierarchical-models.html#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="class-14-hierarchical-models.html#cb37-27" aria-hidden="true" tabindex="-1"></a>Initializing model</span>
<span id="cb37-28"><a href="class-14-hierarchical-models.html#cb37-28" aria-hidden="true" tabindex="-1"></a>fit.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(fit)</span>
<span id="cb37-29"><a href="class-14-hierarchical-models.html#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mcmc)</span>
<span id="cb37-30"><a href="class-14-hierarchical-models.html#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="class-14-hierarchical-models.html#cb37-31" aria-hidden="true" tabindex="-1"></a>Iterations <span class="ot">=</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb37-32"><a href="class-14-hierarchical-models.html#cb37-32" aria-hidden="true" tabindex="-1"></a>Thinning interval <span class="ot">=</span> <span class="dv">1</span> </span>
<span id="cb37-33"><a href="class-14-hierarchical-models.html#cb37-33" aria-hidden="true" tabindex="-1"></a>Number of chains <span class="ot">=</span> <span class="dv">2</span> </span>
<span id="cb37-34"><a href="class-14-hierarchical-models.html#cb37-34" aria-hidden="true" tabindex="-1"></a>Sample size per chain <span class="ot">=</span> <span class="dv">4900</span> </span>
<span id="cb37-35"><a href="class-14-hierarchical-models.html#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="class-14-hierarchical-models.html#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> Empirical mean and standard deviation <span class="cf">for</span> each variable,</span>
<span id="cb37-37"><a href="class-14-hierarchical-models.html#cb37-37" aria-hidden="true" tabindex="-1"></a>   plus standard error of the mean<span class="sc">:</span></span>
<span id="cb37-38"><a href="class-14-hierarchical-models.html#cb37-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-39"><a href="class-14-hierarchical-models.html#cb37-39" aria-hidden="true" tabindex="-1"></a>             Mean      SD  Naive SE Time<span class="sc">-</span>series SE</span>
<span id="cb37-40"><a href="class-14-hierarchical-models.html#cb37-40" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">1</span>]  <span class="fl">0.28964</span> <span class="fl">0.03750</span> <span class="fl">0.0003788</span>      <span class="fl">0.0004795</span></span>
<span id="cb37-41"><a href="class-14-hierarchical-models.html#cb37-41" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">10</span>] <span class="fl">0.10412</span> <span class="fl">0.01983</span> <span class="fl">0.0002004</span>      <span class="fl">0.0002510</span></span>
<span id="cb37-42"><a href="class-14-hierarchical-models.html#cb37-42" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">11</span>] <span class="fl">0.10153</span> <span class="fl">0.01264</span> <span class="fl">0.0001277</span>      <span class="fl">0.0001647</span></span>
<span id="cb37-43"><a href="class-14-hierarchical-models.html#cb37-43" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">12</span>] <span class="fl">0.07702</span> <span class="fl">0.01484</span> <span class="fl">0.0001499</span>      <span class="fl">0.0001984</span></span>
<span id="cb37-44"><a href="class-14-hierarchical-models.html#cb37-44" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">2</span>]  <span class="fl">0.19362</span> <span class="fl">0.03521</span> <span class="fl">0.0003557</span>      <span class="fl">0.0004463</span></span>
<span id="cb37-45"><a href="class-14-hierarchical-models.html#cb37-45" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">3</span>]  <span class="fl">0.15707</span> <span class="fl">0.02807</span> <span class="fl">0.0002836</span>      <span class="fl">0.0003602</span></span>
<span id="cb37-46"><a href="class-14-hierarchical-models.html#cb37-46" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">4</span>]  <span class="fl">0.14576</span> <span class="fl">0.02647</span> <span class="fl">0.0002674</span>      <span class="fl">0.0003341</span></span>
<span id="cb37-47"><a href="class-14-hierarchical-models.html#cb37-47" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">5</span>]  <span class="fl">0.13724</span> <span class="fl">0.02476</span> <span class="fl">0.0002501</span>      <span class="fl">0.0003207</span></span>
<span id="cb37-48"><a href="class-14-hierarchical-models.html#cb37-48" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">6</span>]  <span class="fl">0.13719</span> <span class="fl">0.02426</span> <span class="fl">0.0002451</span>      <span class="fl">0.0003026</span></span>
<span id="cb37-49"><a href="class-14-hierarchical-models.html#cb37-49" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">7</span>]  <span class="fl">0.11155</span> <span class="fl">0.01438</span> <span class="fl">0.0001452</span>      <span class="fl">0.0001784</span></span>
<span id="cb37-50"><a href="class-14-hierarchical-models.html#cb37-50" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">8</span>]  <span class="fl">0.10582</span> <span class="fl">0.01518</span> <span class="fl">0.0001533</span>      <span class="fl">0.0001856</span></span>
<span id="cb37-51"><a href="class-14-hierarchical-models.html#cb37-51" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">9</span>]  <span class="fl">0.10571</span> <span class="fl">0.01731</span> <span class="fl">0.0001749</span>      <span class="fl">0.0002253</span></span>
<span id="cb37-52"><a href="class-14-hierarchical-models.html#cb37-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-53"><a href="class-14-hierarchical-models.html#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Quantiles <span class="cf">for</span> each variable<span class="sc">:</span></span>
<span id="cb37-54"><a href="class-14-hierarchical-models.html#cb37-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-55"><a href="class-14-hierarchical-models.html#cb37-55" aria-hidden="true" tabindex="-1"></a>             <span class="fl">2.5</span><span class="sc">%     25%</span>     <span class="dv">50</span><span class="sc">%     75%</span>  <span class="fl">97.5</span>%</span>
<span id="cb37-56"><a href="class-14-hierarchical-models.html#cb37-56" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">1</span>]  <span class="fl">0.21849</span> <span class="fl">0.26348</span> <span class="fl">0.28889</span> <span class="fl">0.31486</span> <span class="fl">0.3648</span></span>
<span id="cb37-57"><a href="class-14-hierarchical-models.html#cb37-57" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">10</span>] <span class="fl">0.06844</span> <span class="fl">0.08992</span> <span class="fl">0.10300</span> <span class="fl">0.11692</span> <span class="fl">0.1452</span></span>
<span id="cb37-58"><a href="class-14-hierarchical-models.html#cb37-58" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">11</span>] <span class="fl">0.07819</span> <span class="fl">0.09279</span> <span class="fl">0.10081</span> <span class="fl">0.10985</span> <span class="fl">0.1277</span></span>
<span id="cb37-59"><a href="class-14-hierarchical-models.html#cb37-59" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">12</span>] <span class="fl">0.05004</span> <span class="fl">0.06676</span> <span class="fl">0.07615</span> <span class="fl">0.08638</span> <span class="fl">0.1084</span></span>
<span id="cb37-60"><a href="class-14-hierarchical-models.html#cb37-60" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">2</span>]  <span class="fl">0.12915</span> <span class="fl">0.16876</span> <span class="fl">0.19118</span> <span class="fl">0.21676</span> <span class="fl">0.2668</span></span>
<span id="cb37-61"><a href="class-14-hierarchical-models.html#cb37-61" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">3</span>]  <span class="fl">0.10638</span> <span class="fl">0.13730</span> <span class="fl">0.15578</span> <span class="fl">0.17537</span> <span class="fl">0.2154</span></span>
<span id="cb37-62"><a href="class-14-hierarchical-models.html#cb37-62" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">4</span>]  <span class="fl">0.09786</span> <span class="fl">0.12732</span> <span class="fl">0.14413</span> <span class="fl">0.16325</span> <span class="fl">0.2013</span></span>
<span id="cb37-63"><a href="class-14-hierarchical-models.html#cb37-63" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">5</span>]  <span class="fl">0.09274</span> <span class="fl">0.11992</span> <span class="fl">0.13583</span> <span class="fl">0.15317</span> <span class="fl">0.1899</span></span>
<span id="cb37-64"><a href="class-14-hierarchical-models.html#cb37-64" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">6</span>]  <span class="fl">0.09294</span> <span class="fl">0.12013</span> <span class="fl">0.13596</span> <span class="fl">0.15311</span> <span class="fl">0.1885</span></span>
<span id="cb37-65"><a href="class-14-hierarchical-models.html#cb37-65" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">7</span>]  <span class="fl">0.08494</span> <span class="fl">0.10161</span> <span class="fl">0.11087</span> <span class="fl">0.12091</span> <span class="fl">0.1411</span></span>
<span id="cb37-66"><a href="class-14-hierarchical-models.html#cb37-66" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">8</span>]  <span class="fl">0.07796</span> <span class="fl">0.09523</span> <span class="fl">0.10536</span> <span class="fl">0.11565</span> <span class="fl">0.1369</span></span>
<span id="cb37-67"><a href="class-14-hierarchical-models.html#cb37-67" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">9</span>]  <span class="fl">0.07422</span> <span class="fl">0.09363</span> <span class="fl">0.10484</span> <span class="fl">0.11682</span> <span class="fl">0.1420</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html">as.mcmc</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat.ind</span><span class="op">=</span><span class="va">mat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"theta["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">plot_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Posterior distributions of thetas"</span>,</span>
<span>                      <span class="st">"with medians and 95% intervals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>           pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"theta["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span>,</span>
<span>           prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> <span class="va">plot_title</span></span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-5-1.png" width="960"></div>
</div>
<div id="hierarchical-model" class="section level3" number="14.1.3">
<h3>
<span class="header-section-number">14.1.3</span> Hierarchical model<a class="anchor" aria-label="anchor" href="#hierarchical-model"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="class-14-hierarchical-models.html#cb39-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb39-2"><a href="class-14-hierarchical-models.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="class-14-hierarchical-models.html#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Likelihood</span></span>
<span id="cb39-4"><a href="class-14-hierarchical-models.html#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb39-5"><a href="class-14-hierarchical-models.html#cb39-5" aria-hidden="true" tabindex="-1"></a>        y[i] <span class="sc">~</span> <span class="fu">dbin</span>(theta[i], n[i])</span>
<span id="cb39-6"><a href="class-14-hierarchical-models.html#cb39-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">logit</span>(theta[i]) <span class="ot">&lt;-</span> logit.theta[i]</span>
<span id="cb39-7"><a href="class-14-hierarchical-models.html#cb39-7" aria-hidden="true" tabindex="-1"></a>        logit.theta[i] <span class="sc">~</span> <span class="fu">dnorm</span>(mu, inv.sigma.squared)</span>
<span id="cb39-8"><a href="class-14-hierarchical-models.html#cb39-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-9"><a href="class-14-hierarchical-models.html#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="class-14-hierarchical-models.html#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## priors</span></span>
<span id="cb39-11"><a href="class-14-hierarchical-models.html#cb39-11" aria-hidden="true" tabindex="-1"></a>    inv.sigma.squared <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">pow</span>(sigma, <span class="dv">2</span>)</span>
<span id="cb39-12"><a href="class-14-hierarchical-models.html#cb39-12" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb39-13"><a href="class-14-hierarchical-models.html#cb39-13" aria-hidden="true" tabindex="-1"></a>    mu <span class="sc">~</span> <span class="fu">dunif</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb39-14"><a href="class-14-hierarchical-models.html#cb39-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-15"><a href="class-14-hierarchical-models.html#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="class-14-hierarchical-models.html#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="class-14-hierarchical-models.html#cb39-17" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">list</span>(<span class="at">n =</span> bristol<span class="sc">$</span>operations, <span class="at">y =</span> bristol<span class="sc">$</span>deaths)</span>
<span id="cb39-18"><a href="class-14-hierarchical-models.html#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="class-14-hierarchical-models.html#cb39-19" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> data, <span class="at">model =</span> model, <span class="at">parameters.to.save =</span> <span class="fu">c</span>(<span class="st">"theta"</span>,</span>
<span id="cb39-20"><a href="class-14-hierarchical-models.html#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mu"</span>, <span class="st">"sigma"</span>), <span class="at">n.chain =</span> <span class="dv">2</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>, <span class="at">n.thin =</span> <span class="dv">1</span>, <span class="at">n.burn =</span> <span class="dv">100</span>,</span>
<span id="cb39-21"><a href="class-14-hierarchical-models.html#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">DIC =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-22"><a href="class-14-hierarchical-models.html#cb39-22" aria-hidden="true" tabindex="-1"></a>Compiling model graph</span>
<span id="cb39-23"><a href="class-14-hierarchical-models.html#cb39-23" aria-hidden="true" tabindex="-1"></a>   Resolving undeclared variables</span>
<span id="cb39-24"><a href="class-14-hierarchical-models.html#cb39-24" aria-hidden="true" tabindex="-1"></a>   Allocating nodes</span>
<span id="cb39-25"><a href="class-14-hierarchical-models.html#cb39-25" aria-hidden="true" tabindex="-1"></a>Graph information<span class="sc">:</span></span>
<span id="cb39-26"><a href="class-14-hierarchical-models.html#cb39-26" aria-hidden="true" tabindex="-1"></a>   Observed stochastic nodes<span class="sc">:</span> <span class="dv">12</span></span>
<span id="cb39-27"><a href="class-14-hierarchical-models.html#cb39-27" aria-hidden="true" tabindex="-1"></a>   Unobserved stochastic nodes<span class="sc">:</span> <span class="dv">14</span></span>
<span id="cb39-28"><a href="class-14-hierarchical-models.html#cb39-28" aria-hidden="true" tabindex="-1"></a>   Total graph size<span class="sc">:</span> <span class="dv">57</span></span>
<span id="cb39-29"><a href="class-14-hierarchical-models.html#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="class-14-hierarchical-models.html#cb39-30" aria-hidden="true" tabindex="-1"></a>Initializing model</span>
<span id="cb39-31"><a href="class-14-hierarchical-models.html#cb39-31" aria-hidden="true" tabindex="-1"></a>fit.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(fit)</span>
<span id="cb39-32"><a href="class-14-hierarchical-models.html#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.mcmc)</span>
<span id="cb39-33"><a href="class-14-hierarchical-models.html#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="class-14-hierarchical-models.html#cb39-34" aria-hidden="true" tabindex="-1"></a>Iterations <span class="ot">=</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">5000</span></span>
<span id="cb39-35"><a href="class-14-hierarchical-models.html#cb39-35" aria-hidden="true" tabindex="-1"></a>Thinning interval <span class="ot">=</span> <span class="dv">1</span> </span>
<span id="cb39-36"><a href="class-14-hierarchical-models.html#cb39-36" aria-hidden="true" tabindex="-1"></a>Number of chains <span class="ot">=</span> <span class="dv">2</span> </span>
<span id="cb39-37"><a href="class-14-hierarchical-models.html#cb39-37" aria-hidden="true" tabindex="-1"></a>Sample size per chain <span class="ot">=</span> <span class="dv">4900</span> </span>
<span id="cb39-38"><a href="class-14-hierarchical-models.html#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="class-14-hierarchical-models.html#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> Empirical mean and standard deviation <span class="cf">for</span> each variable,</span>
<span id="cb39-40"><a href="class-14-hierarchical-models.html#cb39-40" aria-hidden="true" tabindex="-1"></a>   plus standard error of the mean<span class="sc">:</span></span>
<span id="cb39-41"><a href="class-14-hierarchical-models.html#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="class-14-hierarchical-models.html#cb39-42" aria-hidden="true" tabindex="-1"></a>             Mean      SD  Naive SE Time<span class="sc">-</span>series SE</span>
<span id="cb39-43"><a href="class-14-hierarchical-models.html#cb39-43" aria-hidden="true" tabindex="-1"></a>mu        <span class="sc">-</span><span class="fl">1.9309</span> <span class="fl">0.14106</span> <span class="fl">0.0014249</span>      <span class="fl">0.0018997</span></span>
<span id="cb39-44"><a href="class-14-hierarchical-models.html#cb39-44" aria-hidden="true" tabindex="-1"></a>sigma      <span class="fl">0.4267</span> <span class="fl">0.13195</span> <span class="fl">0.0013329</span>      <span class="fl">0.0027037</span></span>
<span id="cb39-45"><a href="class-14-hierarchical-models.html#cb39-45" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">1</span>]   <span class="fl">0.2496</span> <span class="fl">0.03701</span> <span class="fl">0.0003738</span>      <span class="fl">0.0006270</span></span>
<span id="cb39-46"><a href="class-14-hierarchical-models.html#cb39-46" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">10</span>]  <span class="fl">0.1064</span> <span class="fl">0.01787</span> <span class="fl">0.0001805</span>      <span class="fl">0.0002226</span></span>
<span id="cb39-47"><a href="class-14-hierarchical-models.html#cb39-47" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">11</span>]  <span class="fl">0.1026</span> <span class="fl">0.01216</span> <span class="fl">0.0001229</span>      <span class="fl">0.0001658</span></span>
<span id="cb39-48"><a href="class-14-hierarchical-models.html#cb39-48" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">12</span>]  <span class="fl">0.0842</span> <span class="fl">0.01455</span> <span class="fl">0.0001469</span>      <span class="fl">0.0002097</span></span>
<span id="cb39-49"><a href="class-14-hierarchical-models.html#cb39-49" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">2</span>]   <span class="fl">0.1706</span> <span class="fl">0.03012</span> <span class="fl">0.0003043</span>      <span class="fl">0.0004233</span></span>
<span id="cb39-50"><a href="class-14-hierarchical-models.html#cb39-50" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">3</span>]   <span class="fl">0.1462</span> <span class="fl">0.02427</span> <span class="fl">0.0002452</span>      <span class="fl">0.0003174</span></span>
<span id="cb39-51"><a href="class-14-hierarchical-models.html#cb39-51" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">4</span>]   <span class="fl">0.1376</span> <span class="fl">0.02296</span> <span class="fl">0.0002319</span>      <span class="fl">0.0002905</span></span>
<span id="cb39-52"><a href="class-14-hierarchical-models.html#cb39-52" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">5</span>]   <span class="fl">0.1325</span> <span class="fl">0.02208</span> <span class="fl">0.0002230</span>      <span class="fl">0.0002816</span></span>
<span id="cb39-53"><a href="class-14-hierarchical-models.html#cb39-53" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">6</span>]   <span class="fl">0.1325</span> <span class="fl">0.02183</span> <span class="fl">0.0002205</span>      <span class="fl">0.0002934</span></span>
<span id="cb39-54"><a href="class-14-hierarchical-models.html#cb39-54" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">7</span>]   <span class="fl">0.1123</span> <span class="fl">0.01355</span> <span class="fl">0.0001368</span>      <span class="fl">0.0001707</span></span>
<span id="cb39-55"><a href="class-14-hierarchical-models.html#cb39-55" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">8</span>]   <span class="fl">0.1072</span> <span class="fl">0.01433</span> <span class="fl">0.0001447</span>      <span class="fl">0.0001817</span></span>
<span id="cb39-56"><a href="class-14-hierarchical-models.html#cb39-56" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">9</span>]   <span class="fl">0.1073</span> <span class="fl">0.01641</span> <span class="fl">0.0001658</span>      <span class="fl">0.0002192</span></span>
<span id="cb39-57"><a href="class-14-hierarchical-models.html#cb39-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="class-14-hierarchical-models.html#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Quantiles <span class="cf">for</span> each variable<span class="sc">:</span></span>
<span id="cb39-59"><a href="class-14-hierarchical-models.html#cb39-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-60"><a href="class-14-hierarchical-models.html#cb39-60" aria-hidden="true" tabindex="-1"></a>              <span class="fl">2.5</span><span class="sc">%      25%</span>      <span class="dv">50</span><span class="sc">%     75%</span>   <span class="fl">97.5</span>%</span>
<span id="cb39-61"><a href="class-14-hierarchical-models.html#cb39-61" aria-hidden="true" tabindex="-1"></a>mu        <span class="sc">-</span><span class="fl">2.20675</span> <span class="sc">-</span><span class="fl">2.01880</span> <span class="sc">-</span><span class="fl">1.93144</span> <span class="sc">-</span><span class="fl">1.8430</span> <span class="sc">-</span><span class="fl">1.6404</span></span>
<span id="cb39-62"><a href="class-14-hierarchical-models.html#cb39-62" aria-hidden="true" tabindex="-1"></a>sigma      <span class="fl">0.22923</span>  <span class="fl">0.33369</span>  <span class="fl">0.40612</span>  <span class="fl">0.4949</span>  <span class="fl">0.7390</span></span>
<span id="cb39-63"><a href="class-14-hierarchical-models.html#cb39-63" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">1</span>]   <span class="fl">0.18085</span>  <span class="fl">0.22344</span>  <span class="fl">0.24890</span>  <span class="fl">0.2739</span>  <span class="fl">0.3248</span></span>
<span id="cb39-64"><a href="class-14-hierarchical-models.html#cb39-64" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">10</span>]  <span class="fl">0.07354</span>  <span class="fl">0.09376</span>  <span class="fl">0.10572</span>  <span class="fl">0.1179</span>  <span class="fl">0.1436</span></span>
<span id="cb39-65"><a href="class-14-hierarchical-models.html#cb39-65" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">11</span>]  <span class="fl">0.07990</span>  <span class="fl">0.09428</span>  <span class="fl">0.10233</span>  <span class="fl">0.1108</span>  <span class="fl">0.1271</span></span>
<span id="cb39-66"><a href="class-14-hierarchical-models.html#cb39-66" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">12</span>]  <span class="fl">0.05739</span>  <span class="fl">0.07400</span>  <span class="fl">0.08348</span>  <span class="fl">0.0935</span>  <span class="fl">0.1146</span></span>
<span id="cb39-67"><a href="class-14-hierarchical-models.html#cb39-67" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">2</span>]   <span class="fl">0.11831</span>  <span class="fl">0.14911</span>  <span class="fl">0.16852</span>  <span class="fl">0.1895</span>  <span class="fl">0.2361</span></span>
<span id="cb39-68"><a href="class-14-hierarchical-models.html#cb39-68" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">3</span>]   <span class="fl">0.10274</span>  <span class="fl">0.12908</span>  <span class="fl">0.14512</span>  <span class="fl">0.1617</span>  <span class="fl">0.1969</span></span>
<span id="cb39-69"><a href="class-14-hierarchical-models.html#cb39-69" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">4</span>]   <span class="fl">0.09650</span>  <span class="fl">0.12162</span>  <span class="fl">0.13623</span>  <span class="fl">0.1522</span>  <span class="fl">0.1865</span></span>
<span id="cb39-70"><a href="class-14-hierarchical-models.html#cb39-70" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">5</span>]   <span class="fl">0.09314</span>  <span class="fl">0.11694</span>  <span class="fl">0.13132</span>  <span class="fl">0.1469</span>  <span class="fl">0.1797</span></span>
<span id="cb39-71"><a href="class-14-hierarchical-models.html#cb39-71" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">6</span>]   <span class="fl">0.09328</span>  <span class="fl">0.11738</span>  <span class="fl">0.13131</span>  <span class="fl">0.1462</span>  <span class="fl">0.1791</span></span>
<span id="cb39-72"><a href="class-14-hierarchical-models.html#cb39-72" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">7</span>]   <span class="fl">0.08697</span>  <span class="fl">0.10293</span>  <span class="fl">0.11178</span>  <span class="fl">0.1214</span>  <span class="fl">0.1398</span></span>
<span id="cb39-73"><a href="class-14-hierarchical-models.html#cb39-73" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">8</span>]   <span class="fl">0.08073</span>  <span class="fl">0.09723</span>  <span class="fl">0.10653</span>  <span class="fl">0.1165</span>  <span class="fl">0.1368</span></span>
<span id="cb39-74"><a href="class-14-hierarchical-models.html#cb39-74" aria-hidden="true" tabindex="-1"></a>theta[<span class="dv">9</span>]   <span class="fl">0.07744</span>  <span class="fl">0.09571</span>  <span class="fl">0.10644</span>  <span class="fl">0.1181</span>  <span class="fl">0.1416</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html">as.mcmc</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat.hier</span><span class="op">=</span><span class="va">mat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"theta["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">plot_title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Posterior distributions of thetas"</span>,</span>
<span>                      <span class="st">"with medians and 95% intervals"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="va">mat</span>,</span>
<span>           pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"theta["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,<span class="st">"]"</span><span class="op">)</span>,</span>
<span>           prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span> <span class="va">plot_title</span></span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-7-1.png" width="960"></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="class-14-hierarchical-models.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb41-2"><a href="class-14-hierarchical-models.html#cb41-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">melt</span>(mat.ind) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="class-14-hierarchical-models.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"independent"</span>)</span>
<span id="cb41-4"><a href="class-14-hierarchical-models.html#cb41-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> <span class="fu">melt</span>(mat.hier) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="class-14-hierarchical-models.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"hierarchical"</span>)</span>
<span id="cb41-6"><a href="class-14-hierarchical-models.html#cb41-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">bind_rows</span>(df1, df2)</span>
<span id="cb41-7"><a href="class-14-hierarchical-models.html#cb41-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>hospital <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Bristol"</span>, <span class="st">"Leicester"</span>, <span class="st">"Leeds"</span>, <span class="st">"Oxford"</span>, <span class="st">"Guys"</span>,</span>
<span id="cb41-8"><a href="class-14-hierarchical-models.html#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Liverpool"</span>, <span class="st">"Southampton"</span>, <span class="st">"Great Ormond St"</span>, <span class="st">"Newcastle"</span>,</span>
<span id="cb41-9"><a href="class-14-hierarchical-models.html#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Harefield"</span>, <span class="st">"Birmingham"</span>, <span class="st">"Brompton"</span>)[<span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>Var2))]</span>
<span id="cb41-10"><a href="class-14-hierarchical-models.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="class-14-hierarchical-models.html#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-12"><a href="class-14-hierarchical-models.html#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb41-13"><a href="class-14-hierarchical-models.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb41-14"><a href="class-14-hierarchical-models.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb41-15"><a href="class-14-hierarchical-models.html#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="class-14-hierarchical-models.html#cb41-16" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="class-14-hierarchical-models.html#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> hospital, <span class="at">x =</span> value, <span class="at">fill =</span> model)) <span class="sc">+</span> <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb41-18"><a href="class-14-hierarchical-models.html#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-19"><a href="class-14-hierarchical-models.html#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"lines"</span>),</span>
<span id="cb41-20"><a href="class-14-hierarchical-models.html#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Posterior Distributions"</span>) <span class="sc">+</span></span>
<span id="cb41-21"><a href="class-14-hierarchical-models.html#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> theta.avg, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb41-22"><a href="class-14-hierarchical-models.html#cb41-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb41-23"><a href="class-14-hierarchical-models.html#cb41-23" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Using <span class="st">`</span><span class="at">size</span><span class="st">`</span> aesthetic <span class="cf">for</span> lines was deprecated <span class="cf">in</span> ggplot2</span>
<span id="cb41-24"><a href="class-14-hierarchical-models.html#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>.<span class="dv">4</span>.<span class="fl">0.</span></span>
<span id="cb41-25"><a href="class-14-hierarchical-models.html#cb41-25" aria-hidden="true" tabindex="-1"></a>ℹ Please use <span class="st">`</span><span class="at">linewidth</span><span class="st">`</span> instead.</span>
<span id="cb41-26"><a href="class-14-hierarchical-models.html#cb41-26" aria-hidden="true" tabindex="-1"></a>Picking joint bandwidth of <span class="fl">0.00308</span></span></code></pre></div>
<div class="inline-figure">
<img src="14_files/figure-html/unnamed-chunk-8-1.png" width="672">
Vertical line is the mean theta parameter from the constant-risk model</div>
</div>
</div>
<div id="example-2-james-stein-baseball" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Example 2: James-Stein Baseball<a class="anchor" aria-label="anchor" href="#example-2-james-stein-baseball"><i class="fas fa-link"></i></a>
</h2>
<div class="example lizi">
<p><span id="exm:baseball" class="example"><strong>Example 14.2  (James-Stein baseball) </strong></span>See <a href="https://mc-stan.org/rstanarm/articles/pooling.html">this vignette</a> for more details of this example. The James-Stein baseball data<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Efron and Morris, &lt;span&gt;“Stein’s Paradox in Statistics.”&lt;/span&gt;&lt;/p&gt;"><sup>10</sup></a></span> is analyzed using <code>stan_glm</code> in the <code>rstanarm</code> package. This includes model fits with complete pooling (constant-risk model), no pooling (independent-parameter model), and partial pooling (hierarchical model).</p>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="class-14-hierarchical-models.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb42-2"><a href="class-14-hierarchical-models.html#cb42-2" aria-hidden="true" tabindex="-1"></a>Loading required package<span class="sc">:</span> Rcpp</span>
<span id="cb42-3"><a href="class-14-hierarchical-models.html#cb42-3" aria-hidden="true" tabindex="-1"></a>This is rstanarm version <span class="dv">2</span>.<span class="fl">21.3</span></span>
<span id="cb42-4"><a href="class-14-hierarchical-models.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> See https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>rstanarm<span class="sc">/</span>articles<span class="sc">/</span>priors <span class="cf">for</span> changes to default priors<span class="sc">!</span></span>
<span id="cb42-5"><a href="class-14-hierarchical-models.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> Default priors may change, so it<span class="st">'s safest to specify priors, even if equivalent to the defaults.</span></span>
<span id="cb42-6"><a href="class-14-hierarchical-models.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="st">- For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span id="cb42-7"><a href="class-14-hierarchical-models.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="st">  options(mc.cores = parallel::detectCores())</span></span>
<span id="cb42-8"><a href="class-14-hierarchical-models.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="st">data(bball1970)</span></span>
<span id="cb42-9"><a href="class-14-hierarchical-models.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="st">bball &lt;- bball1970</span></span>
<span id="cb42-10"><a href="class-14-hierarchical-models.html#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="class-14-hierarchical-models.html#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="st"># xtable(bball)</span></span>
<span id="cb42-12"><a href="class-14-hierarchical-models.html#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="class-14-hierarchical-models.html#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="st">kbl(bball) %&gt;%</span></span>
<span id="cb42-14"><a href="class-14-hierarchical-models.html#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="st">    kable_classic_2(full_width = F)</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Player
</th>
<th style="text-align:right;">
AB
</th>
<th style="text-align:right;">
Hits
</th>
<th style="text-align:right;">
RemainingAB
</th>
<th style="text-align:right;">
RemainingHits
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Clemente
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
367
</td>
<td style="text-align:right;">
127
</td>
</tr>
<tr>
<td style="text-align:left;">
Robinson
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
426
</td>
<td style="text-align:right;">
127
</td>
</tr>
<tr>
<td style="text-align:left;">
Howard
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
144
</td>
</tr>
<tr>
<td style="text-align:left;">
Johnstone
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
275
</td>
<td style="text-align:right;">
61
</td>
</tr>
<tr>
<td style="text-align:left;">
Berry
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
418
</td>
<td style="text-align:right;">
114
</td>
</tr>
<tr>
<td style="text-align:left;">
Spencer
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
466
</td>
<td style="text-align:right;">
126
</td>
</tr>
<tr>
<td style="text-align:left;">
Kessinger
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
586
</td>
<td style="text-align:right;">
155
</td>
</tr>
<tr>
<td style="text-align:left;">
Alvarado
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
Santo
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
510
</td>
<td style="text-align:right;">
137
</td>
</tr>
<tr>
<td style="text-align:left;">
Swaboda
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:left;">
Petrocelli
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
538
</td>
<td style="text-align:right;">
142
</td>
</tr>
<tr>
<td style="text-align:left;">
Rodriguez
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
186
</td>
<td style="text-align:right;">
42
</td>
</tr>
<tr>
<td style="text-align:left;">
Scott
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
435
</td>
<td style="text-align:right;">
132
</td>
</tr>
<tr>
<td style="text-align:left;">
Unser
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
277
</td>
<td style="text-align:right;">
73
</td>
</tr>
<tr>
<td style="text-align:left;">
Williams
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
591
</td>
<td style="text-align:right;">
195
</td>
</tr>
<tr>
<td style="text-align:left;">
Campaneris
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
558
</td>
<td style="text-align:right;">
159
</td>
</tr>
<tr>
<td style="text-align:left;">
Munson
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
408
</td>
<td style="text-align:right;">
129
</td>
</tr>
<tr>
<td style="text-align:left;">
Alvis
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="class-14-hierarchical-models.html#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="class-14-hierarchical-models.html#cb43-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(bball)</span>
<span id="cb43-3"><a href="class-14-hierarchical-models.html#cb43-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> bball<span class="sc">$</span>AB</span>
<span id="cb43-4"><a href="class-14-hierarchical-models.html#cb43-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> bball<span class="sc">$</span>Hits</span>
<span id="cb43-5"><a href="class-14-hierarchical-models.html#cb43-5" aria-hidden="true" tabindex="-1"></a>K_new <span class="ot">&lt;-</span> bball<span class="sc">$</span>RemainingAB</span>
<span id="cb43-6"><a href="class-14-hierarchical-models.html#cb43-6" aria-hidden="true" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> bball<span class="sc">$</span>RemainingHits</span>
<span id="cb43-7"><a href="class-14-hierarchical-models.html#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="class-14-hierarchical-models.html#cb43-8" aria-hidden="true" tabindex="-1"></a>batting_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">print</span>(<span class="fu">format</span>(<span class="fu">round</span>(x, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb43-9"><a href="class-14-hierarchical-models.html#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsmall =</span> <span class="dv">3</span>), <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-10"><a href="class-14-hierarchical-models.html#cb43-10" aria-hidden="true" tabindex="-1"></a>player_avgs <span class="ot">&lt;-</span> y<span class="sc">/</span>K  <span class="co"># player avgs through 45 AB</span></span>
<span id="cb43-11"><a href="class-14-hierarchical-models.html#cb43-11" aria-hidden="true" tabindex="-1"></a>tot_avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)<span class="sc">/</span><span class="fu">sum</span>(K)  <span class="co"># overall avg through 45 AB</span></span>
<span id="cb43-12"><a href="class-14-hierarchical-models.html#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="class-14-hierarchical-models.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Player averages through 45 at-bats:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb43-14"><a href="class-14-hierarchical-models.html#cb43-14" aria-hidden="true" tabindex="-1"></a>Player averages through <span class="dv">45</span> at<span class="sc">-</span>bats<span class="sc">:</span></span>
<span id="cb43-15"><a href="class-14-hierarchical-models.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(player_avgs)</span>
<span id="cb43-16"><a href="class-14-hierarchical-models.html#cb43-16" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.400</span> <span class="fl">0.378</span> <span class="fl">0.356</span> <span class="fl">0.333</span> <span class="fl">0.311</span> <span class="fl">0.311</span> <span class="fl">0.289</span> <span class="fl">0.267</span> <span class="fl">0.244</span></span>
<span id="cb43-17"><a href="class-14-hierarchical-models.html#cb43-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10</span>] <span class="fl">0.244</span> <span class="fl">0.222</span> <span class="fl">0.222</span> <span class="fl">0.222</span> <span class="fl">0.222</span> <span class="fl">0.222</span> <span class="fl">0.200</span> <span class="fl">0.178</span> <span class="fl">0.156</span></span>
<span id="cb43-18"><a href="class-14-hierarchical-models.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Overall average through 45 at-bats:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb43-19"><a href="class-14-hierarchical-models.html#cb43-19" aria-hidden="true" tabindex="-1"></a>Overall average through <span class="dv">45</span> at<span class="sc">-</span>bats<span class="sc">:</span></span>
<span id="cb43-20"><a href="class-14-hierarchical-models.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(tot_avg)</span>
<span id="cb43-21"><a href="class-14-hierarchical-models.html#cb43-21" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.265</span></span></code></pre></div>
<div id="complete-pooling" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">14.2.1</span> Complete pooling<a class="anchor" aria-label="anchor" href="#complete-pooling"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="class-14-hierarchical-models.html#cb44-1" aria-hidden="true" tabindex="-1"></a>SEED <span class="ot">&lt;-</span> <span class="dv">202</span></span>
<span id="cb44-2"><a href="class-14-hierarchical-models.html#cb44-2" aria-hidden="true" tabindex="-1"></a>wi_prior <span class="ot">&lt;-</span> <span class="fu">normal</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># weakly informative prior on log-odds</span></span>
<span id="cb44-3"><a href="class-14-hierarchical-models.html#cb44-3" aria-hidden="true" tabindex="-1"></a>fit_pool <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(<span class="fu">cbind</span>(Hits, AB <span class="sc">-</span> Hits) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> bball, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>),</span>
<span id="cb44-4"><a href="class-14-hierarchical-models.html#cb44-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prior_intercept =</span> wi_prior, <span class="at">seed =</span> SEED)</span>
<span id="cb44-5"><a href="class-14-hierarchical-models.html#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="class-14-hierarchical-models.html#cb44-6" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb44-7"><a href="class-14-hierarchical-models.html#cb44-7" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb44-8"><a href="class-14-hierarchical-models.html#cb44-8" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">2.2e-05</span> seconds</span>
<span id="cb44-9"><a href="class-14-hierarchical-models.html#cb44-9" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.22</span> seconds.</span>
<span id="cb44-10"><a href="class-14-hierarchical-models.html#cb44-10" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb44-11"><a href="class-14-hierarchical-models.html#cb44-11" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb44-12"><a href="class-14-hierarchical-models.html#cb44-12" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb44-13"><a href="class-14-hierarchical-models.html#cb44-13" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb44-14"><a href="class-14-hierarchical-models.html#cb44-14" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb44-15"><a href="class-14-hierarchical-models.html#cb44-15" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb44-16"><a href="class-14-hierarchical-models.html#cb44-16" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb44-17"><a href="class-14-hierarchical-models.html#cb44-17" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb44-18"><a href="class-14-hierarchical-models.html#cb44-18" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb44-19"><a href="class-14-hierarchical-models.html#cb44-19" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb44-20"><a href="class-14-hierarchical-models.html#cb44-20" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb44-21"><a href="class-14-hierarchical-models.html#cb44-21" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb44-22"><a href="class-14-hierarchical-models.html#cb44-22" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb44-23"><a href="class-14-hierarchical-models.html#cb44-23" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb44-24"><a href="class-14-hierarchical-models.html#cb44-24" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb44-25"><a href="class-14-hierarchical-models.html#cb44-25" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb44-26"><a href="class-14-hierarchical-models.html#cb44-26" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.015257</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb44-27"><a href="class-14-hierarchical-models.html#cb44-27" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.018122</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb44-28"><a href="class-14-hierarchical-models.html#cb44-28" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.033379</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb44-29"><a href="class-14-hierarchical-models.html#cb44-29" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb44-30"><a href="class-14-hierarchical-models.html#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="class-14-hierarchical-models.html#cb44-31" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb44-32"><a href="class-14-hierarchical-models.html#cb44-32" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb44-33"><a href="class-14-hierarchical-models.html#cb44-33" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">5e-06</span> seconds</span>
<span id="cb44-34"><a href="class-14-hierarchical-models.html#cb44-34" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.05</span> seconds.</span>
<span id="cb44-35"><a href="class-14-hierarchical-models.html#cb44-35" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb44-36"><a href="class-14-hierarchical-models.html#cb44-36" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb44-37"><a href="class-14-hierarchical-models.html#cb44-37" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb44-38"><a href="class-14-hierarchical-models.html#cb44-38" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb44-39"><a href="class-14-hierarchical-models.html#cb44-39" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb44-40"><a href="class-14-hierarchical-models.html#cb44-40" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb44-41"><a href="class-14-hierarchical-models.html#cb44-41" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb44-42"><a href="class-14-hierarchical-models.html#cb44-42" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb44-43"><a href="class-14-hierarchical-models.html#cb44-43" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb44-44"><a href="class-14-hierarchical-models.html#cb44-44" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb44-45"><a href="class-14-hierarchical-models.html#cb44-45" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb44-46"><a href="class-14-hierarchical-models.html#cb44-46" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb44-47"><a href="class-14-hierarchical-models.html#cb44-47" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb44-48"><a href="class-14-hierarchical-models.html#cb44-48" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb44-49"><a href="class-14-hierarchical-models.html#cb44-49" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb44-50"><a href="class-14-hierarchical-models.html#cb44-50" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb44-51"><a href="class-14-hierarchical-models.html#cb44-51" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.015807</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb44-52"><a href="class-14-hierarchical-models.html#cb44-52" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.017317</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb44-53"><a href="class-14-hierarchical-models.html#cb44-53" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.033124</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb44-54"><a href="class-14-hierarchical-models.html#cb44-54" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb44-55"><a href="class-14-hierarchical-models.html#cb44-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-56"><a href="class-14-hierarchical-models.html#cb44-56" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb44-57"><a href="class-14-hierarchical-models.html#cb44-57" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb44-58"><a href="class-14-hierarchical-models.html#cb44-58" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">1.1e-05</span> seconds</span>
<span id="cb44-59"><a href="class-14-hierarchical-models.html#cb44-59" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.11</span> seconds.</span>
<span id="cb44-60"><a href="class-14-hierarchical-models.html#cb44-60" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb44-61"><a href="class-14-hierarchical-models.html#cb44-61" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb44-62"><a href="class-14-hierarchical-models.html#cb44-62" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb44-63"><a href="class-14-hierarchical-models.html#cb44-63" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb44-64"><a href="class-14-hierarchical-models.html#cb44-64" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb44-65"><a href="class-14-hierarchical-models.html#cb44-65" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb44-66"><a href="class-14-hierarchical-models.html#cb44-66" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb44-67"><a href="class-14-hierarchical-models.html#cb44-67" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb44-68"><a href="class-14-hierarchical-models.html#cb44-68" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb44-69"><a href="class-14-hierarchical-models.html#cb44-69" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb44-70"><a href="class-14-hierarchical-models.html#cb44-70" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb44-71"><a href="class-14-hierarchical-models.html#cb44-71" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb44-72"><a href="class-14-hierarchical-models.html#cb44-72" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb44-73"><a href="class-14-hierarchical-models.html#cb44-73" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb44-74"><a href="class-14-hierarchical-models.html#cb44-74" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb44-75"><a href="class-14-hierarchical-models.html#cb44-75" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb44-76"><a href="class-14-hierarchical-models.html#cb44-76" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.015199</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb44-77"><a href="class-14-hierarchical-models.html#cb44-77" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.018457</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb44-78"><a href="class-14-hierarchical-models.html#cb44-78" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.033656</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb44-79"><a href="class-14-hierarchical-models.html#cb44-79" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb44-80"><a href="class-14-hierarchical-models.html#cb44-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-81"><a href="class-14-hierarchical-models.html#cb44-81" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb44-82"><a href="class-14-hierarchical-models.html#cb44-82" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb44-83"><a href="class-14-hierarchical-models.html#cb44-83" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">4e-06</span> seconds</span>
<span id="cb44-84"><a href="class-14-hierarchical-models.html#cb44-84" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.04</span> seconds.</span>
<span id="cb44-85"><a href="class-14-hierarchical-models.html#cb44-85" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb44-86"><a href="class-14-hierarchical-models.html#cb44-86" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb44-87"><a href="class-14-hierarchical-models.html#cb44-87" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb44-88"><a href="class-14-hierarchical-models.html#cb44-88" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb44-89"><a href="class-14-hierarchical-models.html#cb44-89" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb44-90"><a href="class-14-hierarchical-models.html#cb44-90" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb44-91"><a href="class-14-hierarchical-models.html#cb44-91" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb44-92"><a href="class-14-hierarchical-models.html#cb44-92" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb44-93"><a href="class-14-hierarchical-models.html#cb44-93" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb44-94"><a href="class-14-hierarchical-models.html#cb44-94" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb44-95"><a href="class-14-hierarchical-models.html#cb44-95" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb44-96"><a href="class-14-hierarchical-models.html#cb44-96" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb44-97"><a href="class-14-hierarchical-models.html#cb44-97" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb44-98"><a href="class-14-hierarchical-models.html#cb44-98" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb44-99"><a href="class-14-hierarchical-models.html#cb44-99" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb44-100"><a href="class-14-hierarchical-models.html#cb44-100" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb44-101"><a href="class-14-hierarchical-models.html#cb44-101" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.01666</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb44-102"><a href="class-14-hierarchical-models.html#cb44-102" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.018921</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb44-103"><a href="class-14-hierarchical-models.html#cb44-103" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.035581</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb44-104"><a href="class-14-hierarchical-models.html#cb44-104" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb44-105"><a href="class-14-hierarchical-models.html#cb44-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-106"><a href="class-14-hierarchical-models.html#cb44-106" aria-hidden="true" tabindex="-1"></a>invlogit <span class="ot">&lt;-</span> plogis  <span class="co"># function(x) 1/(1 + exp(-x))</span></span>
<span id="cb44-107"><a href="class-14-hierarchical-models.html#cb44-107" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(posterior) {</span>
<span id="cb44-108"><a href="class-14-hierarchical-models.html#cb44-108" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">invlogit</span>(posterior)  <span class="co"># log-odds -&gt; probabilities</span></span>
<span id="cb44-109"><a href="class-14-hierarchical-models.html#cb44-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>))) </span>
<span id="cb44-110"><a href="class-14-hierarchical-models.html#cb44-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-111"><a href="class-14-hierarchical-models.html#cb44-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-112"><a href="class-14-hierarchical-models.html#cb44-112" aria-hidden="true" tabindex="-1"></a>pool <span class="ot">&lt;-</span> <span class="fu">summary_stats</span>(<span class="fu">as.matrix</span>(fit_pool))  <span class="co"># as.matrix extracts the posterior draws</span></span>
<span id="cb44-113"><a href="class-14-hierarchical-models.html#cb44-113" aria-hidden="true" tabindex="-1"></a>pool <span class="ot">&lt;-</span> <span class="fu">matrix</span>(pool,  <span class="co"># replicate to give each player the same estimates</span></span>
<span id="cb44-114"><a href="class-14-hierarchical-models.html#cb44-114" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(bball), <span class="fu">ncol</span>(pool), <span class="at">byrow =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-115"><a href="class-14-hierarchical-models.html#cb44-115" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(bball<span class="sc">$</span>Player, <span class="fu">c</span>(<span class="st">"10%"</span>, <span class="st">"50%"</span>, <span class="st">"90%"</span>)))</span>
<span id="cb44-116"><a href="class-14-hierarchical-models.html#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(pool)</span>
<span id="cb44-117"><a href="class-14-hierarchical-models.html#cb44-117" aria-hidden="true" tabindex="-1"></a>           <span class="dv">10</span><span class="sc">%   50%</span>   <span class="dv">90</span>%  </span>
<span id="cb44-118"><a href="class-14-hierarchical-models.html#cb44-118" aria-hidden="true" tabindex="-1"></a>Clemente   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-119"><a href="class-14-hierarchical-models.html#cb44-119" aria-hidden="true" tabindex="-1"></a>Robinson   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-120"><a href="class-14-hierarchical-models.html#cb44-120" aria-hidden="true" tabindex="-1"></a>Howard     <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-121"><a href="class-14-hierarchical-models.html#cb44-121" aria-hidden="true" tabindex="-1"></a>Johnstone  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-122"><a href="class-14-hierarchical-models.html#cb44-122" aria-hidden="true" tabindex="-1"></a>Berry      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-123"><a href="class-14-hierarchical-models.html#cb44-123" aria-hidden="true" tabindex="-1"></a>Spencer    <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-124"><a href="class-14-hierarchical-models.html#cb44-124" aria-hidden="true" tabindex="-1"></a>Kessinger  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-125"><a href="class-14-hierarchical-models.html#cb44-125" aria-hidden="true" tabindex="-1"></a>Alvarado   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-126"><a href="class-14-hierarchical-models.html#cb44-126" aria-hidden="true" tabindex="-1"></a>Santo      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-127"><a href="class-14-hierarchical-models.html#cb44-127" aria-hidden="true" tabindex="-1"></a>Swaboda    <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-128"><a href="class-14-hierarchical-models.html#cb44-128" aria-hidden="true" tabindex="-1"></a>Petrocelli <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-129"><a href="class-14-hierarchical-models.html#cb44-129" aria-hidden="true" tabindex="-1"></a>Rodriguez  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-130"><a href="class-14-hierarchical-models.html#cb44-130" aria-hidden="true" tabindex="-1"></a>Scott      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-131"><a href="class-14-hierarchical-models.html#cb44-131" aria-hidden="true" tabindex="-1"></a>Unser      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-132"><a href="class-14-hierarchical-models.html#cb44-132" aria-hidden="true" tabindex="-1"></a>Williams   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-133"><a href="class-14-hierarchical-models.html#cb44-133" aria-hidden="true" tabindex="-1"></a>Campaneris <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-134"><a href="class-14-hierarchical-models.html#cb44-134" aria-hidden="true" tabindex="-1"></a>Munson     <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-135"><a href="class-14-hierarchical-models.html#cb44-135" aria-hidden="true" tabindex="-1"></a>Alvis      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-136"><a href="class-14-hierarchical-models.html#cb44-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-137"><a href="class-14-hierarchical-models.html#cb44-137" aria-hidden="true" tabindex="-1"></a>invlogit <span class="ot">&lt;-</span> plogis  <span class="co"># function(x) 1/(1 + exp(-x))</span></span>
<span id="cb44-138"><a href="class-14-hierarchical-models.html#cb44-138" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(posterior) {</span>
<span id="cb44-139"><a href="class-14-hierarchical-models.html#cb44-139" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">invlogit</span>(posterior)  <span class="co"># log-odds -&gt; probabilities</span></span>
<span id="cb44-140"><a href="class-14-hierarchical-models.html#cb44-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>)))</span>
<span id="cb44-141"><a href="class-14-hierarchical-models.html#cb44-141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-142"><a href="class-14-hierarchical-models.html#cb44-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-143"><a href="class-14-hierarchical-models.html#cb44-143" aria-hidden="true" tabindex="-1"></a>pool <span class="ot">&lt;-</span> <span class="fu">summary_stats</span>(<span class="fu">as.matrix</span>(fit_pool))  <span class="co"># as.matrix extracts the posterior draws</span></span>
<span id="cb44-144"><a href="class-14-hierarchical-models.html#cb44-144" aria-hidden="true" tabindex="-1"></a>pool <span class="ot">&lt;-</span> <span class="fu">matrix</span>(pool,  <span class="co"># replicate to give each player the same estimates</span></span>
<span id="cb44-145"><a href="class-14-hierarchical-models.html#cb44-145" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(bball), <span class="fu">ncol</span>(pool), <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-146"><a href="class-14-hierarchical-models.html#cb44-146" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(bball<span class="sc">$</span>Player, <span class="fu">c</span>(<span class="st">"10%"</span>, <span class="st">"50%"</span>, <span class="st">"90%"</span>)))</span>
<span id="cb44-147"><a href="class-14-hierarchical-models.html#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(pool)</span>
<span id="cb44-148"><a href="class-14-hierarchical-models.html#cb44-148" aria-hidden="true" tabindex="-1"></a>           <span class="dv">10</span><span class="sc">%   50%</span>   <span class="dv">90</span>%  </span>
<span id="cb44-149"><a href="class-14-hierarchical-models.html#cb44-149" aria-hidden="true" tabindex="-1"></a>Clemente   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-150"><a href="class-14-hierarchical-models.html#cb44-150" aria-hidden="true" tabindex="-1"></a>Robinson   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-151"><a href="class-14-hierarchical-models.html#cb44-151" aria-hidden="true" tabindex="-1"></a>Howard     <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-152"><a href="class-14-hierarchical-models.html#cb44-152" aria-hidden="true" tabindex="-1"></a>Johnstone  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-153"><a href="class-14-hierarchical-models.html#cb44-153" aria-hidden="true" tabindex="-1"></a>Berry      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-154"><a href="class-14-hierarchical-models.html#cb44-154" aria-hidden="true" tabindex="-1"></a>Spencer    <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-155"><a href="class-14-hierarchical-models.html#cb44-155" aria-hidden="true" tabindex="-1"></a>Kessinger  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-156"><a href="class-14-hierarchical-models.html#cb44-156" aria-hidden="true" tabindex="-1"></a>Alvarado   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-157"><a href="class-14-hierarchical-models.html#cb44-157" aria-hidden="true" tabindex="-1"></a>Santo      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-158"><a href="class-14-hierarchical-models.html#cb44-158" aria-hidden="true" tabindex="-1"></a>Swaboda    <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-159"><a href="class-14-hierarchical-models.html#cb44-159" aria-hidden="true" tabindex="-1"></a>Petrocelli <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-160"><a href="class-14-hierarchical-models.html#cb44-160" aria-hidden="true" tabindex="-1"></a>Rodriguez  <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-161"><a href="class-14-hierarchical-models.html#cb44-161" aria-hidden="true" tabindex="-1"></a>Scott      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-162"><a href="class-14-hierarchical-models.html#cb44-162" aria-hidden="true" tabindex="-1"></a>Unser      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-163"><a href="class-14-hierarchical-models.html#cb44-163" aria-hidden="true" tabindex="-1"></a>Williams   <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-164"><a href="class-14-hierarchical-models.html#cb44-164" aria-hidden="true" tabindex="-1"></a>Campaneris <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-165"><a href="class-14-hierarchical-models.html#cb44-165" aria-hidden="true" tabindex="-1"></a>Munson     <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span>
<span id="cb44-166"><a href="class-14-hierarchical-models.html#cb44-166" aria-hidden="true" tabindex="-1"></a>Alvis      <span class="fl">0.246</span> <span class="fl">0.265</span> <span class="fl">0.286</span></span></code></pre></div>
</div>
<div id="no-pooling" class="section level3" number="14.2.2">
<h3>
<span class="header-section-number">14.2.2</span> No pooling<a class="anchor" aria-label="anchor" href="#no-pooling"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="class-14-hierarchical-models.html#cb45-1" aria-hidden="true" tabindex="-1"></a>fit_nopool <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_pool, <span class="at">formula =</span> . <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Player, <span class="at">prior =</span> wi_prior)</span>
<span id="cb45-2"><a href="class-14-hierarchical-models.html#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="class-14-hierarchical-models.html#cb45-3" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb45-4"><a href="class-14-hierarchical-models.html#cb45-4" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb45-5"><a href="class-14-hierarchical-models.html#cb45-5" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">3.8e-05</span> seconds</span>
<span id="cb45-6"><a href="class-14-hierarchical-models.html#cb45-6" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.38</span> seconds.</span>
<span id="cb45-7"><a href="class-14-hierarchical-models.html#cb45-7" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb45-8"><a href="class-14-hierarchical-models.html#cb45-8" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb45-9"><a href="class-14-hierarchical-models.html#cb45-9" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb45-10"><a href="class-14-hierarchical-models.html#cb45-10" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb45-11"><a href="class-14-hierarchical-models.html#cb45-11" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb45-12"><a href="class-14-hierarchical-models.html#cb45-12" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb45-13"><a href="class-14-hierarchical-models.html#cb45-13" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb45-14"><a href="class-14-hierarchical-models.html#cb45-14" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb45-15"><a href="class-14-hierarchical-models.html#cb45-15" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb45-16"><a href="class-14-hierarchical-models.html#cb45-16" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb45-17"><a href="class-14-hierarchical-models.html#cb45-17" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb45-18"><a href="class-14-hierarchical-models.html#cb45-18" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb45-19"><a href="class-14-hierarchical-models.html#cb45-19" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb45-20"><a href="class-14-hierarchical-models.html#cb45-20" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb45-21"><a href="class-14-hierarchical-models.html#cb45-21" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb45-22"><a href="class-14-hierarchical-models.html#cb45-22" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb45-23"><a href="class-14-hierarchical-models.html#cb45-23" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.069053</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb45-24"><a href="class-14-hierarchical-models.html#cb45-24" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.080344</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb45-25"><a href="class-14-hierarchical-models.html#cb45-25" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.149397</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb45-26"><a href="class-14-hierarchical-models.html#cb45-26" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb45-27"><a href="class-14-hierarchical-models.html#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="class-14-hierarchical-models.html#cb45-28" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb45-29"><a href="class-14-hierarchical-models.html#cb45-29" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb45-30"><a href="class-14-hierarchical-models.html#cb45-30" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">1.1e-05</span> seconds</span>
<span id="cb45-31"><a href="class-14-hierarchical-models.html#cb45-31" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.11</span> seconds.</span>
<span id="cb45-32"><a href="class-14-hierarchical-models.html#cb45-32" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb45-33"><a href="class-14-hierarchical-models.html#cb45-33" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb45-34"><a href="class-14-hierarchical-models.html#cb45-34" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb45-35"><a href="class-14-hierarchical-models.html#cb45-35" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb45-36"><a href="class-14-hierarchical-models.html#cb45-36" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb45-37"><a href="class-14-hierarchical-models.html#cb45-37" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb45-38"><a href="class-14-hierarchical-models.html#cb45-38" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb45-39"><a href="class-14-hierarchical-models.html#cb45-39" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb45-40"><a href="class-14-hierarchical-models.html#cb45-40" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb45-41"><a href="class-14-hierarchical-models.html#cb45-41" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb45-42"><a href="class-14-hierarchical-models.html#cb45-42" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb45-43"><a href="class-14-hierarchical-models.html#cb45-43" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb45-44"><a href="class-14-hierarchical-models.html#cb45-44" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb45-45"><a href="class-14-hierarchical-models.html#cb45-45" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb45-46"><a href="class-14-hierarchical-models.html#cb45-46" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb45-47"><a href="class-14-hierarchical-models.html#cb45-47" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb45-48"><a href="class-14-hierarchical-models.html#cb45-48" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.067713</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb45-49"><a href="class-14-hierarchical-models.html#cb45-49" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.076083</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb45-50"><a href="class-14-hierarchical-models.html#cb45-50" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.143796</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb45-51"><a href="class-14-hierarchical-models.html#cb45-51" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb45-52"><a href="class-14-hierarchical-models.html#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="class-14-hierarchical-models.html#cb45-53" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb45-54"><a href="class-14-hierarchical-models.html#cb45-54" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb45-55"><a href="class-14-hierarchical-models.html#cb45-55" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">8e-06</span> seconds</span>
<span id="cb45-56"><a href="class-14-hierarchical-models.html#cb45-56" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.08</span> seconds.</span>
<span id="cb45-57"><a href="class-14-hierarchical-models.html#cb45-57" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb45-58"><a href="class-14-hierarchical-models.html#cb45-58" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb45-59"><a href="class-14-hierarchical-models.html#cb45-59" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb45-60"><a href="class-14-hierarchical-models.html#cb45-60" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb45-61"><a href="class-14-hierarchical-models.html#cb45-61" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb45-62"><a href="class-14-hierarchical-models.html#cb45-62" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb45-63"><a href="class-14-hierarchical-models.html#cb45-63" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb45-64"><a href="class-14-hierarchical-models.html#cb45-64" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb45-65"><a href="class-14-hierarchical-models.html#cb45-65" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb45-66"><a href="class-14-hierarchical-models.html#cb45-66" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb45-67"><a href="class-14-hierarchical-models.html#cb45-67" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb45-68"><a href="class-14-hierarchical-models.html#cb45-68" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb45-69"><a href="class-14-hierarchical-models.html#cb45-69" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb45-70"><a href="class-14-hierarchical-models.html#cb45-70" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb45-71"><a href="class-14-hierarchical-models.html#cb45-71" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb45-72"><a href="class-14-hierarchical-models.html#cb45-72" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb45-73"><a href="class-14-hierarchical-models.html#cb45-73" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.064684</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb45-74"><a href="class-14-hierarchical-models.html#cb45-74" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.074064</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb45-75"><a href="class-14-hierarchical-models.html#cb45-75" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.138748</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb45-76"><a href="class-14-hierarchical-models.html#cb45-76" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb45-77"><a href="class-14-hierarchical-models.html#cb45-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-78"><a href="class-14-hierarchical-models.html#cb45-78" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb45-79"><a href="class-14-hierarchical-models.html#cb45-79" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb45-80"><a href="class-14-hierarchical-models.html#cb45-80" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">7e-06</span> seconds</span>
<span id="cb45-81"><a href="class-14-hierarchical-models.html#cb45-81" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.07</span> seconds.</span>
<span id="cb45-82"><a href="class-14-hierarchical-models.html#cb45-82" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb45-83"><a href="class-14-hierarchical-models.html#cb45-83" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb45-84"><a href="class-14-hierarchical-models.html#cb45-84" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb45-85"><a href="class-14-hierarchical-models.html#cb45-85" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb45-86"><a href="class-14-hierarchical-models.html#cb45-86" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb45-87"><a href="class-14-hierarchical-models.html#cb45-87" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb45-88"><a href="class-14-hierarchical-models.html#cb45-88" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb45-89"><a href="class-14-hierarchical-models.html#cb45-89" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb45-90"><a href="class-14-hierarchical-models.html#cb45-90" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb45-91"><a href="class-14-hierarchical-models.html#cb45-91" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb45-92"><a href="class-14-hierarchical-models.html#cb45-92" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb45-93"><a href="class-14-hierarchical-models.html#cb45-93" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb45-94"><a href="class-14-hierarchical-models.html#cb45-94" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb45-95"><a href="class-14-hierarchical-models.html#cb45-95" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb45-96"><a href="class-14-hierarchical-models.html#cb45-96" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb45-97"><a href="class-14-hierarchical-models.html#cb45-97" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb45-98"><a href="class-14-hierarchical-models.html#cb45-98" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.068065</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb45-99"><a href="class-14-hierarchical-models.html#cb45-99" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.08149</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb45-100"><a href="class-14-hierarchical-models.html#cb45-100" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.149555</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb45-101"><a href="class-14-hierarchical-models.html#cb45-101" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb45-102"><a href="class-14-hierarchical-models.html#cb45-102" aria-hidden="true" tabindex="-1"></a>nopool <span class="ot">&lt;-</span> <span class="fu">summary_stats</span>(<span class="fu">as.matrix</span>(fit_nopool))</span>
<span id="cb45-103"><a href="class-14-hierarchical-models.html#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(nopool) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(bball<span class="sc">$</span>Player)</span>
<span id="cb45-104"><a href="class-14-hierarchical-models.html#cb45-104" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(nopool)</span>
<span id="cb45-105"><a href="class-14-hierarchical-models.html#cb45-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb45-106"><a href="class-14-hierarchical-models.html#cb45-106" aria-hidden="true" tabindex="-1"></a>parameters   <span class="dv">10</span><span class="sc">%   50%</span>   <span class="dv">90</span>%  </span>
<span id="cb45-107"><a href="class-14-hierarchical-models.html#cb45-107" aria-hidden="true" tabindex="-1"></a>  Clemente   <span class="fl">0.297</span> <span class="fl">0.386</span> <span class="fl">0.484</span></span>
<span id="cb45-108"><a href="class-14-hierarchical-models.html#cb45-108" aria-hidden="true" tabindex="-1"></a>  Robinson   <span class="fl">0.281</span> <span class="fl">0.365</span> <span class="fl">0.456</span></span>
<span id="cb45-109"><a href="class-14-hierarchical-models.html#cb45-109" aria-hidden="true" tabindex="-1"></a>  Howard     <span class="fl">0.265</span> <span class="fl">0.345</span> <span class="fl">0.434</span></span>
<span id="cb45-110"><a href="class-14-hierarchical-models.html#cb45-110" aria-hidden="true" tabindex="-1"></a>  Johnstone  <span class="fl">0.242</span> <span class="fl">0.325</span> <span class="fl">0.418</span></span>
<span id="cb45-111"><a href="class-14-hierarchical-models.html#cb45-111" aria-hidden="true" tabindex="-1"></a>  Berry      <span class="fl">0.226</span> <span class="fl">0.306</span> <span class="fl">0.390</span></span>
<span id="cb45-112"><a href="class-14-hierarchical-models.html#cb45-112" aria-hidden="true" tabindex="-1"></a>  Spencer    <span class="fl">0.225</span> <span class="fl">0.304</span> <span class="fl">0.391</span></span>
<span id="cb45-113"><a href="class-14-hierarchical-models.html#cb45-113" aria-hidden="true" tabindex="-1"></a>  Kessinger  <span class="fl">0.207</span> <span class="fl">0.284</span> <span class="fl">0.371</span></span>
<span id="cb45-114"><a href="class-14-hierarchical-models.html#cb45-114" aria-hidden="true" tabindex="-1"></a>  Alvarado   <span class="fl">0.188</span> <span class="fl">0.265</span> <span class="fl">0.353</span></span>
<span id="cb45-115"><a href="class-14-hierarchical-models.html#cb45-115" aria-hidden="true" tabindex="-1"></a>  Santo      <span class="fl">0.175</span> <span class="fl">0.246</span> <span class="fl">0.328</span></span>
<span id="cb45-116"><a href="class-14-hierarchical-models.html#cb45-116" aria-hidden="true" tabindex="-1"></a>  Swaboda    <span class="fl">0.175</span> <span class="fl">0.245</span> <span class="fl">0.327</span></span>
<span id="cb45-117"><a href="class-14-hierarchical-models.html#cb45-117" aria-hidden="true" tabindex="-1"></a>  Petrocelli <span class="fl">0.154</span> <span class="fl">0.223</span> <span class="fl">0.304</span></span>
<span id="cb45-118"><a href="class-14-hierarchical-models.html#cb45-118" aria-hidden="true" tabindex="-1"></a>  Rodriguez  <span class="fl">0.155</span> <span class="fl">0.224</span> <span class="fl">0.303</span></span>
<span id="cb45-119"><a href="class-14-hierarchical-models.html#cb45-119" aria-hidden="true" tabindex="-1"></a>  Scott      <span class="fl">0.159</span> <span class="fl">0.223</span> <span class="fl">0.303</span></span>
<span id="cb45-120"><a href="class-14-hierarchical-models.html#cb45-120" aria-hidden="true" tabindex="-1"></a>  Unser      <span class="fl">0.153</span> <span class="fl">0.224</span> <span class="fl">0.307</span></span>
<span id="cb45-121"><a href="class-14-hierarchical-models.html#cb45-121" aria-hidden="true" tabindex="-1"></a>  Williams   <span class="fl">0.156</span> <span class="fl">0.224</span> <span class="fl">0.304</span></span>
<span id="cb45-122"><a href="class-14-hierarchical-models.html#cb45-122" aria-hidden="true" tabindex="-1"></a>  Campaneris <span class="fl">0.138</span> <span class="fl">0.204</span> <span class="fl">0.284</span></span>
<span id="cb45-123"><a href="class-14-hierarchical-models.html#cb45-123" aria-hidden="true" tabindex="-1"></a>  Munson     <span class="fl">0.124</span> <span class="fl">0.185</span> <span class="fl">0.260</span></span>
<span id="cb45-124"><a href="class-14-hierarchical-models.html#cb45-124" aria-hidden="true" tabindex="-1"></a>  Alvis      <span class="fl">0.107</span> <span class="fl">0.164</span> <span class="fl">0.241</span></span></code></pre></div>
</div>
<div id="partial-pooling" class="section level3" number="14.2.3">
<h3>
<span class="header-section-number">14.2.3</span> Partial pooling<a class="anchor" aria-label="anchor" href="#partial-pooling"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="class-14-hierarchical-models.html#cb46-1" aria-hidden="true" tabindex="-1"></a>fit_partialpool <span class="ot">&lt;-</span> <span class="fu">stan_glmer</span>(<span class="fu">cbind</span>(Hits, AB <span class="sc">-</span> Hits) <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Player),</span>
<span id="cb46-2"><a href="class-14-hierarchical-models.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> bball, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="st">"logit"</span>), <span class="at">prior_intercept =</span> wi_prior,</span>
<span id="cb46-3"><a href="class-14-hierarchical-models.html#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> SEED)</span>
<span id="cb46-4"><a href="class-14-hierarchical-models.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="class-14-hierarchical-models.html#cb46-5" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb46-6"><a href="class-14-hierarchical-models.html#cb46-6" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb46-7"><a href="class-14-hierarchical-models.html#cb46-7" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">2.7e-05</span> seconds</span>
<span id="cb46-8"><a href="class-14-hierarchical-models.html#cb46-8" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.27</span> seconds.</span>
<span id="cb46-9"><a href="class-14-hierarchical-models.html#cb46-9" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb46-10"><a href="class-14-hierarchical-models.html#cb46-10" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb46-11"><a href="class-14-hierarchical-models.html#cb46-11" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb46-12"><a href="class-14-hierarchical-models.html#cb46-12" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb46-13"><a href="class-14-hierarchical-models.html#cb46-13" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb46-14"><a href="class-14-hierarchical-models.html#cb46-14" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb46-15"><a href="class-14-hierarchical-models.html#cb46-15" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb46-16"><a href="class-14-hierarchical-models.html#cb46-16" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb46-17"><a href="class-14-hierarchical-models.html#cb46-17" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb46-18"><a href="class-14-hierarchical-models.html#cb46-18" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb46-19"><a href="class-14-hierarchical-models.html#cb46-19" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb46-20"><a href="class-14-hierarchical-models.html#cb46-20" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb46-21"><a href="class-14-hierarchical-models.html#cb46-21" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb46-22"><a href="class-14-hierarchical-models.html#cb46-22" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb46-23"><a href="class-14-hierarchical-models.html#cb46-23" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb46-24"><a href="class-14-hierarchical-models.html#cb46-24" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb46-25"><a href="class-14-hierarchical-models.html#cb46-25" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.119321</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb46-26"><a href="class-14-hierarchical-models.html#cb46-26" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.125259</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb46-27"><a href="class-14-hierarchical-models.html#cb46-27" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.24458</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb46-28"><a href="class-14-hierarchical-models.html#cb46-28" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb46-29"><a href="class-14-hierarchical-models.html#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="class-14-hierarchical-models.html#cb46-30" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb46-31"><a href="class-14-hierarchical-models.html#cb46-31" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb46-32"><a href="class-14-hierarchical-models.html#cb46-32" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">9e-06</span> seconds</span>
<span id="cb46-33"><a href="class-14-hierarchical-models.html#cb46-33" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.09</span> seconds.</span>
<span id="cb46-34"><a href="class-14-hierarchical-models.html#cb46-34" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb46-35"><a href="class-14-hierarchical-models.html#cb46-35" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb46-36"><a href="class-14-hierarchical-models.html#cb46-36" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb46-37"><a href="class-14-hierarchical-models.html#cb46-37" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb46-38"><a href="class-14-hierarchical-models.html#cb46-38" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb46-39"><a href="class-14-hierarchical-models.html#cb46-39" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb46-40"><a href="class-14-hierarchical-models.html#cb46-40" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb46-41"><a href="class-14-hierarchical-models.html#cb46-41" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb46-42"><a href="class-14-hierarchical-models.html#cb46-42" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb46-43"><a href="class-14-hierarchical-models.html#cb46-43" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb46-44"><a href="class-14-hierarchical-models.html#cb46-44" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb46-45"><a href="class-14-hierarchical-models.html#cb46-45" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb46-46"><a href="class-14-hierarchical-models.html#cb46-46" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb46-47"><a href="class-14-hierarchical-models.html#cb46-47" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb46-48"><a href="class-14-hierarchical-models.html#cb46-48" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb46-49"><a href="class-14-hierarchical-models.html#cb46-49" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb46-50"><a href="class-14-hierarchical-models.html#cb46-50" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.141288</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb46-51"><a href="class-14-hierarchical-models.html#cb46-51" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.106701</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb46-52"><a href="class-14-hierarchical-models.html#cb46-52" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.247989</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb46-53"><a href="class-14-hierarchical-models.html#cb46-53" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb46-54"><a href="class-14-hierarchical-models.html#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="class-14-hierarchical-models.html#cb46-55" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb46-56"><a href="class-14-hierarchical-models.html#cb46-56" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb46-57"><a href="class-14-hierarchical-models.html#cb46-57" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">6e-06</span> seconds</span>
<span id="cb46-58"><a href="class-14-hierarchical-models.html#cb46-58" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.06</span> seconds.</span>
<span id="cb46-59"><a href="class-14-hierarchical-models.html#cb46-59" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb46-60"><a href="class-14-hierarchical-models.html#cb46-60" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb46-61"><a href="class-14-hierarchical-models.html#cb46-61" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb46-62"><a href="class-14-hierarchical-models.html#cb46-62" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb46-63"><a href="class-14-hierarchical-models.html#cb46-63" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb46-64"><a href="class-14-hierarchical-models.html#cb46-64" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb46-65"><a href="class-14-hierarchical-models.html#cb46-65" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb46-66"><a href="class-14-hierarchical-models.html#cb46-66" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb46-67"><a href="class-14-hierarchical-models.html#cb46-67" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb46-68"><a href="class-14-hierarchical-models.html#cb46-68" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb46-69"><a href="class-14-hierarchical-models.html#cb46-69" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb46-70"><a href="class-14-hierarchical-models.html#cb46-70" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb46-71"><a href="class-14-hierarchical-models.html#cb46-71" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb46-72"><a href="class-14-hierarchical-models.html#cb46-72" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb46-73"><a href="class-14-hierarchical-models.html#cb46-73" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb46-74"><a href="class-14-hierarchical-models.html#cb46-74" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb46-75"><a href="class-14-hierarchical-models.html#cb46-75" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.133025</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb46-76"><a href="class-14-hierarchical-models.html#cb46-76" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.143619</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb46-77"><a href="class-14-hierarchical-models.html#cb46-77" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.276644</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb46-78"><a href="class-14-hierarchical-models.html#cb46-78" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb46-79"><a href="class-14-hierarchical-models.html#cb46-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-80"><a href="class-14-hierarchical-models.html#cb46-80" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'binomial'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb46-81"><a href="class-14-hierarchical-models.html#cb46-81" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb46-82"><a href="class-14-hierarchical-models.html#cb46-82" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">9e-06</span> seconds</span>
<span id="cb46-83"><a href="class-14-hierarchical-models.html#cb46-83" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.09</span> seconds.</span>
<span id="cb46-84"><a href="class-14-hierarchical-models.html#cb46-84" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb46-85"><a href="class-14-hierarchical-models.html#cb46-85" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb46-86"><a href="class-14-hierarchical-models.html#cb46-86" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb46-87"><a href="class-14-hierarchical-models.html#cb46-87" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb46-88"><a href="class-14-hierarchical-models.html#cb46-88" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb46-89"><a href="class-14-hierarchical-models.html#cb46-89" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb46-90"><a href="class-14-hierarchical-models.html#cb46-90" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb46-91"><a href="class-14-hierarchical-models.html#cb46-91" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb46-92"><a href="class-14-hierarchical-models.html#cb46-92" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb46-93"><a href="class-14-hierarchical-models.html#cb46-93" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb46-94"><a href="class-14-hierarchical-models.html#cb46-94" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb46-95"><a href="class-14-hierarchical-models.html#cb46-95" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb46-96"><a href="class-14-hierarchical-models.html#cb46-96" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb46-97"><a href="class-14-hierarchical-models.html#cb46-97" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb46-98"><a href="class-14-hierarchical-models.html#cb46-98" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb46-99"><a href="class-14-hierarchical-models.html#cb46-99" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb46-100"><a href="class-14-hierarchical-models.html#cb46-100" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.116647</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb46-101"><a href="class-14-hierarchical-models.html#cb46-101" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.084232</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb46-102"><a href="class-14-hierarchical-models.html#cb46-102" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.200879</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb46-103"><a href="class-14-hierarchical-models.html#cb46-103" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb46-104"><a href="class-14-hierarchical-models.html#cb46-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-105"><a href="class-14-hierarchical-models.html#cb46-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-106"><a href="class-14-hierarchical-models.html#cb46-106" aria-hidden="true" tabindex="-1"></a><span class="co"># shift each player's estimate by intercept (and then drop</span></span>
<span id="cb46-107"><a href="class-14-hierarchical-models.html#cb46-107" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept)</span></span>
<span id="cb46-108"><a href="class-14-hierarchical-models.html#cb46-108" aria-hidden="true" tabindex="-1"></a>shift_draws <span class="ot">&lt;-</span> <span class="cf">function</span>(draws) {</span>
<span id="cb46-109"><a href="class-14-hierarchical-models.html#cb46-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sweep</span>(draws[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">STATS =</span> draws[, <span class="dv">1</span>], <span class="at">FUN =</span> <span class="st">"+"</span>)</span>
<span id="cb46-110"><a href="class-14-hierarchical-models.html#cb46-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-111"><a href="class-14-hierarchical-models.html#cb46-111" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">shift_draws</span>(<span class="fu">as.matrix</span>(fit_partialpool))</span>
<span id="cb46-112"><a href="class-14-hierarchical-models.html#cb46-112" aria-hidden="true" tabindex="-1"></a>partialpool <span class="ot">&lt;-</span> <span class="fu">summary_stats</span>(alphas)</span>
<span id="cb46-113"><a href="class-14-hierarchical-models.html#cb46-113" aria-hidden="true" tabindex="-1"></a>partialpool <span class="ot">&lt;-</span> partialpool[<span class="sc">-</span><span class="fu">nrow</span>(partialpool), ]</span>
<span id="cb46-114"><a href="class-14-hierarchical-models.html#cb46-114" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(partialpool) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(bball<span class="sc">$</span>Player)</span>
<span id="cb46-115"><a href="class-14-hierarchical-models.html#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="fu">batting_avg</span>(partialpool)</span>
<span id="cb46-116"><a href="class-14-hierarchical-models.html#cb46-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb46-117"><a href="class-14-hierarchical-models.html#cb46-117" aria-hidden="true" tabindex="-1"></a>parameters   <span class="dv">10</span><span class="sc">%   50%</span>   <span class="dv">90</span>%  </span>
<span id="cb46-118"><a href="class-14-hierarchical-models.html#cb46-118" aria-hidden="true" tabindex="-1"></a>  Clemente   <span class="fl">0.249</span> <span class="fl">0.283</span> <span class="fl">0.349</span></span>
<span id="cb46-119"><a href="class-14-hierarchical-models.html#cb46-119" aria-hidden="true" tabindex="-1"></a>  Robinson   <span class="fl">0.246</span> <span class="fl">0.281</span> <span class="fl">0.341</span></span>
<span id="cb46-120"><a href="class-14-hierarchical-models.html#cb46-120" aria-hidden="true" tabindex="-1"></a>  Howard     <span class="fl">0.243</span> <span class="fl">0.277</span> <span class="fl">0.332</span></span>
<span id="cb46-121"><a href="class-14-hierarchical-models.html#cb46-121" aria-hidden="true" tabindex="-1"></a>  Johnstone  <span class="fl">0.239</span> <span class="fl">0.274</span> <span class="fl">0.324</span></span>
<span id="cb46-122"><a href="class-14-hierarchical-models.html#cb46-122" aria-hidden="true" tabindex="-1"></a>  Berry      <span class="fl">0.237</span> <span class="fl">0.271</span> <span class="fl">0.317</span></span>
<span id="cb46-123"><a href="class-14-hierarchical-models.html#cb46-123" aria-hidden="true" tabindex="-1"></a>  Spencer    <span class="fl">0.238</span> <span class="fl">0.271</span> <span class="fl">0.317</span></span>
<span id="cb46-124"><a href="class-14-hierarchical-models.html#cb46-124" aria-hidden="true" tabindex="-1"></a>  Kessinger  <span class="fl">0.232</span> <span class="fl">0.267</span> <span class="fl">0.309</span></span>
<span id="cb46-125"><a href="class-14-hierarchical-models.html#cb46-125" aria-hidden="true" tabindex="-1"></a>  Alvarado   <span class="fl">0.226</span> <span class="fl">0.265</span> <span class="fl">0.303</span></span>
<span id="cb46-126"><a href="class-14-hierarchical-models.html#cb46-126" aria-hidden="true" tabindex="-1"></a>  Santo      <span class="fl">0.222</span> <span class="fl">0.261</span> <span class="fl">0.298</span></span>
<span id="cb46-127"><a href="class-14-hierarchical-models.html#cb46-127" aria-hidden="true" tabindex="-1"></a>  Swaboda    <span class="fl">0.221</span> <span class="fl">0.261</span> <span class="fl">0.301</span></span>
<span id="cb46-128"><a href="class-14-hierarchical-models.html#cb46-128" aria-hidden="true" tabindex="-1"></a>  Petrocelli <span class="fl">0.217</span> <span class="fl">0.258</span> <span class="fl">0.293</span></span>
<span id="cb46-129"><a href="class-14-hierarchical-models.html#cb46-129" aria-hidden="true" tabindex="-1"></a>  Rodriguez  <span class="fl">0.215</span> <span class="fl">0.258</span> <span class="fl">0.294</span></span>
<span id="cb46-130"><a href="class-14-hierarchical-models.html#cb46-130" aria-hidden="true" tabindex="-1"></a>  Scott      <span class="fl">0.217</span> <span class="fl">0.259</span> <span class="fl">0.294</span></span>
<span id="cb46-131"><a href="class-14-hierarchical-models.html#cb46-131" aria-hidden="true" tabindex="-1"></a>  Unser      <span class="fl">0.214</span> <span class="fl">0.258</span> <span class="fl">0.295</span></span>
<span id="cb46-132"><a href="class-14-hierarchical-models.html#cb46-132" aria-hidden="true" tabindex="-1"></a>  Williams   <span class="fl">0.215</span> <span class="fl">0.258</span> <span class="fl">0.295</span></span>
<span id="cb46-133"><a href="class-14-hierarchical-models.html#cb46-133" aria-hidden="true" tabindex="-1"></a>  Campaneris <span class="fl">0.210</span> <span class="fl">0.255</span> <span class="fl">0.292</span></span>
<span id="cb46-134"><a href="class-14-hierarchical-models.html#cb46-134" aria-hidden="true" tabindex="-1"></a>  Munson     <span class="fl">0.204</span> <span class="fl">0.252</span> <span class="fl">0.287</span></span>
<span id="cb46-135"><a href="class-14-hierarchical-models.html#cb46-135" aria-hidden="true" tabindex="-1"></a>  Alvis      <span class="fl">0.195</span> <span class="fl">0.249</span> <span class="fl">0.284</span></span></code></pre></div>
</div>
<div id="observed-vs-estimated" class="section level3" number="14.2.4">
<h3>
<span class="header-section-number">14.2.4</span> Observed vs estimated<a class="anchor" aria-label="anchor" href="#observed-vs-estimated"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="class-14-hierarchical-models.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-2"><a href="class-14-hierarchical-models.html#cb47-2" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"complete pooling"</span>, <span class="st">"no pooling"</span>, <span class="st">"partial pooling"</span>)</span>
<span id="cb47-3"><a href="class-14-hierarchical-models.html#cb47-3" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pool, nopool, partialpool)</span>
<span id="cb47-4"><a href="class-14-hierarchical-models.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(estimates) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lb"</span>, <span class="st">"median"</span>, <span class="st">"ub"</span>)</span>
<span id="cb47-5"><a href="class-14-hierarchical-models.html#cb47-5" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(estimates, <span class="at">observed =</span> <span class="fu">rep</span>(player_avgs,</span>
<span id="cb47-6"><a href="class-14-hierarchical-models.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">times =</span> <span class="fu">length</span>(models)), <span class="at">model =</span> <span class="fu">rep</span>(models, <span class="at">each =</span> N), <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb47-7"><a href="class-14-hierarchical-models.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="class-14-hierarchical-models.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> median, <span class="at">ymin =</span> lb, <span class="at">ymax =</span> ub)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="class-14-hierarchical-models.html#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> tot_avg, <span class="at">color =</span> <span class="st">"lightpink"</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb47-10"><a href="class-14-hierarchical-models.html#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"skyblue"</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="class-14-hierarchical-models.html#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"gray60"</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb47-12"><a href="class-14-hierarchical-models.html#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"gray30"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">stroke =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="class-14-hierarchical-models.html#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(. <span class="sc">~</span> model) <span class="sc">+</span> <span class="fu">coord_fixed</span>() <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,</span>
<span id="cb47-14"><a href="class-14-hierarchical-models.html#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.3</span>, <span class="fl">0.4</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed Hits / AB"</span>, <span class="at">y =</span> <span class="st">"Predicted chance of hit"</span>) <span class="sc">+</span></span>
<span id="cb47-15"><a href="class-14-hierarchical-models.html#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Posterior Medians and 80% Intervals"</span>)</span>
<span id="cb47-16"><a href="class-14-hierarchical-models.html#cb47-16" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Using <span class="st">`</span><span class="at">size</span><span class="st">`</span> aesthetic <span class="cf">for</span> lines was deprecated <span class="cf">in</span> ggplot2</span>
<span id="cb47-17"><a href="class-14-hierarchical-models.html#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>.<span class="dv">4</span>.<span class="fl">0.</span></span>
<span id="cb47-18"><a href="class-14-hierarchical-models.html#cb47-18" aria-hidden="true" tabindex="-1"></a>ℹ Please use <span class="st">`</span><span class="at">linewidth</span><span class="st">`</span> instead.</span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
<div class="exercise prob">
<p><span id="exr:rats" class="exercise"><strong>Exercise 14.1  (Rat tumors) </strong></span>(Tarone, 1982)<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Robert E Tarone, &lt;span&gt;“The Use of Historical Control Information in Testing for a Trend in Proportions,”&lt;/span&gt; &lt;em&gt;Biometrics&lt;/em&gt;, 1982, 215–20, &lt;a href="https://ezaccess.libraries.psu.edu/login?url=https://www.jstor.org/stable/2530304" role="doc-biblioref"&gt;https://ezaccess.libraries.psu.edu/login?url=https://www.jstor.org/stable/2530304&lt;/a&gt;.&lt;/p&gt;'><sup>11</sup></a></span> provides a data set of tumor incidence in historical control groups of rats; specifically endometrial stromal polyps in female lab rats of type F344 and analyzed in (Gelman, 2021)<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Andrew Gelman et al., &lt;em&gt;Bayesian Data Analysis&lt;/em&gt;, Third (with errors fixed as of 15 February 2021) (CRC Press, 2021), &lt;a href="http://www.stat.columbia.edu/~gelman/book/BDA3.pdf" role="doc-biblioref"&gt;http://www.stat.columbia.edu/~gelman/book/BDA3.pdf&lt;/a&gt;.&lt;/p&gt;'><sup>12</sup></a></span>. The dataset can be accessed <a href="http://www.stat.columbia.edu/~gelman/book/data/rats.asc">here</a> or loaded in R with the <code>rstanarm</code> package using</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">tumors</span>, package <span class="op">=</span> <span class="st">"rstanarm"</span><span class="op">)</span></span></code></pre></div>
<p>Fit a hierarchical Bayesian model to the data and reproduce Figure 5.4 on page 113 of (Gelman, 2021)<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Gelman et al.&lt;/p&gt;"><sup>13</sup></a></span>.</p>
</div>
</div>
</div>
<div id="example-3-chatgpt" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Example 3: ChatGPT<a class="anchor" aria-label="anchor" href="#example-3-chatgpt"><i class="fas fa-link"></i></a>
</h2>
<div class="example lizi">
<p><span id="exm:chatgpt" class="example"><strong>Example 14.3  (ChatGPT Hierarchical model) </strong></span>ChatGPT: stan code of a hierarchical model.</p>
</div>
<p>Sure! Here is an example of a hierarchical model in Stan. The model assumes that we have a set of data points, y, that come from different groups, and we want to model the variation in the data within each group and the variation in the group means across all groups.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb49-1"><a href="class-14-hierarchical-models.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb49-2"><a href="class-14-hierarchical-models.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;  <span class="co">// number of observations</span></span>
<span id="cb49-3"><a href="class-14-hierarchical-models.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; K;  <span class="co">// number of groups</span></span>
<span id="cb49-4"><a href="class-14-hierarchical-models.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>, <span class="kw">upper</span>=K&gt; group[N];  <span class="co">// group indicator for each observation</span></span>
<span id="cb49-5"><a href="class-14-hierarchical-models.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> y[N];  <span class="co">// observed data</span></span>
<span id="cb49-6"><a href="class-14-hierarchical-models.html#cb49-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-7"><a href="class-14-hierarchical-models.html#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="class-14-hierarchical-models.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb49-9"><a href="class-14-hierarchical-models.html#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> mu0;             <span class="co">// prior mean for group means</span></span>
<span id="cb49-10"><a href="class-14-hierarchical-models.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma0;  <span class="co">// prior std. dev. for group means</span></span>
<span id="cb49-11"><a href="class-14-hierarchical-models.html#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; sigma;   <span class="co">// std. dev. of the observations within each group</span></span>
<span id="cb49-12"><a href="class-14-hierarchical-models.html#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[K] mu;          <span class="co">// group means</span></span>
<span id="cb49-13"><a href="class-14-hierarchical-models.html#cb49-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-14"><a href="class-14-hierarchical-models.html#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="class-14-hierarchical-models.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb49-16"><a href="class-14-hierarchical-models.html#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Priors</span></span>
<span id="cb49-17"><a href="class-14-hierarchical-models.html#cb49-17" aria-hidden="true" tabindex="-1"></a>  mu ~ normal(mu0, sigma0);  <span class="co">// prior for group means</span></span>
<span id="cb49-18"><a href="class-14-hierarchical-models.html#cb49-18" aria-hidden="true" tabindex="-1"></a>  sigma ~ cauchy(<span class="dv">0</span>, <span class="dv">1</span>);      <span class="co">// weakly informative prior for sigma</span></span>
<span id="cb49-19"><a href="class-14-hierarchical-models.html#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="class-14-hierarchical-models.html#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Likelihood</span></span>
<span id="cb49-21"><a href="class-14-hierarchical-models.html#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb49-22"><a href="class-14-hierarchical-models.html#cb49-22" aria-hidden="true" tabindex="-1"></a>    y[i] ~ normal(mu[group[i]], sigma);</span>
<span id="cb49-23"><a href="class-14-hierarchical-models.html#cb49-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-24"><a href="class-14-hierarchical-models.html#cb49-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="class-14-hierarchical-models.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb50-2"><a href="class-14-hierarchical-models.html#cb50-2" aria-hidden="true" tabindex="-1"></a>Loading required package<span class="sc">:</span> StanHeaders</span>
<span id="cb50-3"><a href="class-14-hierarchical-models.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan</span> (Version <span class="dv">2</span>.<span class="fl">21.8</span>, GitRev<span class="sc">:</span> <span class="fl">2e1</span>f913d3ca3)</span>
<span id="cb50-4"><a href="class-14-hierarchical-models.html#cb50-4" aria-hidden="true" tabindex="-1"></a>For execution on a local, multicore CPU with excess RAM we recommend calling</span>
<span id="cb50-5"><a href="class-14-hierarchical-models.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()).</span>
<span id="cb50-6"><a href="class-14-hierarchical-models.html#cb50-6" aria-hidden="true" tabindex="-1"></a>To avoid recompilation of unchanged Stan programs, we recommend calling</span>
<span id="cb50-7"><a href="class-14-hierarchical-models.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-8"><a href="class-14-hierarchical-models.html#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="class-14-hierarchical-models.html#cb50-9" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">'rstan'</span></span>
<span id="cb50-10"><a href="class-14-hierarchical-models.html#cb50-10" aria-hidden="true" tabindex="-1"></a>The following object is masked from <span class="st">'package:R2jags'</span><span class="sc">:</span></span>
<span id="cb50-11"><a href="class-14-hierarchical-models.html#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="class-14-hierarchical-models.html#cb50-12" aria-hidden="true" tabindex="-1"></a>    traceplot</span>
<span id="cb50-13"><a href="class-14-hierarchical-models.html#cb50-13" aria-hidden="true" tabindex="-1"></a>The following object is masked from <span class="st">'package:coda'</span><span class="sc">:</span></span>
<span id="cb50-14"><a href="class-14-hierarchical-models.html#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="class-14-hierarchical-models.html#cb50-15" aria-hidden="true" tabindex="-1"></a>    traceplot</span>
<span id="cb50-16"><a href="class-14-hierarchical-models.html#cb50-16" aria-hidden="true" tabindex="-1"></a>The following object is masked from <span class="st">'package:tidyr'</span><span class="sc">:</span></span>
<span id="cb50-17"><a href="class-14-hierarchical-models.html#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="class-14-hierarchical-models.html#cb50-18" aria-hidden="true" tabindex="-1"></a>    extract</span>
<span id="cb50-19"><a href="class-14-hierarchical-models.html#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="class-14-hierarchical-models.html#cb50-20" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">23</span>, <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">25</span>, <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">27</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">21</span>)</span>
<span id="cb50-21"><a href="class-14-hierarchical-models.html#cb50-21" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">10</span>))</span>
<span id="cb50-22"><a href="class-14-hierarchical-models.html#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="class-14-hierarchical-models.html#cb50-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-24"><a href="class-14-hierarchical-models.html#cb50-24" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb50-25"><a href="class-14-hierarchical-models.html#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(y), </span>
<span id="cb50-26"><a href="class-14-hierarchical-models.html#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">length</span>(<span class="fu">unique</span>(group)), </span>
<span id="cb50-27"><a href="class-14-hierarchical-models.html#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> group, </span>
<span id="cb50-28"><a href="class-14-hierarchical-models.html#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y</span>
<span id="cb50-29"><a href="class-14-hierarchical-models.html#cb50-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-30"><a href="class-14-hierarchical-models.html#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="class-14-hierarchical-models.html#cb50-31" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sampling</span>(hierarchical_model, <span class="at">data =</span> data_list, <span class="at">chains =</span> <span class="dv">4</span>)</span>
<span id="cb50-32"><a href="class-14-hierarchical-models.html#cb50-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-33"><a href="class-14-hierarchical-models.html#cb50-33" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'5d501e12f9a845a1624a7fc2585b1bfe'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb50-34"><a href="class-14-hierarchical-models.html#cb50-34" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb50-35"><a href="class-14-hierarchical-models.html#cb50-35" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">9e-06</span> seconds</span>
<span id="cb50-36"><a href="class-14-hierarchical-models.html#cb50-36" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.09</span> seconds.</span>
<span id="cb50-37"><a href="class-14-hierarchical-models.html#cb50-37" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb50-38"><a href="class-14-hierarchical-models.html#cb50-38" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb50-39"><a href="class-14-hierarchical-models.html#cb50-39" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb50-40"><a href="class-14-hierarchical-models.html#cb50-40" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb50-41"><a href="class-14-hierarchical-models.html#cb50-41" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb50-42"><a href="class-14-hierarchical-models.html#cb50-42" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb50-43"><a href="class-14-hierarchical-models.html#cb50-43" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb50-44"><a href="class-14-hierarchical-models.html#cb50-44" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb50-45"><a href="class-14-hierarchical-models.html#cb50-45" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb50-46"><a href="class-14-hierarchical-models.html#cb50-46" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb50-47"><a href="class-14-hierarchical-models.html#cb50-47" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb50-48"><a href="class-14-hierarchical-models.html#cb50-48" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb50-49"><a href="class-14-hierarchical-models.html#cb50-49" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb50-50"><a href="class-14-hierarchical-models.html#cb50-50" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb50-51"><a href="class-14-hierarchical-models.html#cb50-51" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb50-52"><a href="class-14-hierarchical-models.html#cb50-52" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb50-53"><a href="class-14-hierarchical-models.html#cb50-53" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.06359</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb50-54"><a href="class-14-hierarchical-models.html#cb50-54" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.056947</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb50-55"><a href="class-14-hierarchical-models.html#cb50-55" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.120537</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb50-56"><a href="class-14-hierarchical-models.html#cb50-56" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb50-57"><a href="class-14-hierarchical-models.html#cb50-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-58"><a href="class-14-hierarchical-models.html#cb50-58" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'5d501e12f9a845a1624a7fc2585b1bfe'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb50-59"><a href="class-14-hierarchical-models.html#cb50-59" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb50-60"><a href="class-14-hierarchical-models.html#cb50-60" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">3e-06</span> seconds</span>
<span id="cb50-61"><a href="class-14-hierarchical-models.html#cb50-61" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.03</span> seconds.</span>
<span id="cb50-62"><a href="class-14-hierarchical-models.html#cb50-62" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb50-63"><a href="class-14-hierarchical-models.html#cb50-63" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb50-64"><a href="class-14-hierarchical-models.html#cb50-64" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb50-65"><a href="class-14-hierarchical-models.html#cb50-65" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb50-66"><a href="class-14-hierarchical-models.html#cb50-66" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb50-67"><a href="class-14-hierarchical-models.html#cb50-67" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb50-68"><a href="class-14-hierarchical-models.html#cb50-68" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb50-69"><a href="class-14-hierarchical-models.html#cb50-69" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb50-70"><a href="class-14-hierarchical-models.html#cb50-70" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb50-71"><a href="class-14-hierarchical-models.html#cb50-71" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb50-72"><a href="class-14-hierarchical-models.html#cb50-72" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb50-73"><a href="class-14-hierarchical-models.html#cb50-73" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb50-74"><a href="class-14-hierarchical-models.html#cb50-74" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb50-75"><a href="class-14-hierarchical-models.html#cb50-75" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb50-76"><a href="class-14-hierarchical-models.html#cb50-76" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb50-77"><a href="class-14-hierarchical-models.html#cb50-77" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb50-78"><a href="class-14-hierarchical-models.html#cb50-78" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.064281</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb50-79"><a href="class-14-hierarchical-models.html#cb50-79" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.113505</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb50-80"><a href="class-14-hierarchical-models.html#cb50-80" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.177786</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb50-81"><a href="class-14-hierarchical-models.html#cb50-81" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb50-82"><a href="class-14-hierarchical-models.html#cb50-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-83"><a href="class-14-hierarchical-models.html#cb50-83" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'5d501e12f9a845a1624a7fc2585b1bfe'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb50-84"><a href="class-14-hierarchical-models.html#cb50-84" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb50-85"><a href="class-14-hierarchical-models.html#cb50-85" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">2e-06</span> seconds</span>
<span id="cb50-86"><a href="class-14-hierarchical-models.html#cb50-86" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.02</span> seconds.</span>
<span id="cb50-87"><a href="class-14-hierarchical-models.html#cb50-87" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb50-88"><a href="class-14-hierarchical-models.html#cb50-88" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb50-89"><a href="class-14-hierarchical-models.html#cb50-89" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb50-90"><a href="class-14-hierarchical-models.html#cb50-90" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb50-91"><a href="class-14-hierarchical-models.html#cb50-91" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb50-92"><a href="class-14-hierarchical-models.html#cb50-92" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb50-93"><a href="class-14-hierarchical-models.html#cb50-93" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb50-94"><a href="class-14-hierarchical-models.html#cb50-94" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb50-95"><a href="class-14-hierarchical-models.html#cb50-95" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb50-96"><a href="class-14-hierarchical-models.html#cb50-96" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb50-97"><a href="class-14-hierarchical-models.html#cb50-97" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb50-98"><a href="class-14-hierarchical-models.html#cb50-98" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb50-99"><a href="class-14-hierarchical-models.html#cb50-99" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb50-100"><a href="class-14-hierarchical-models.html#cb50-100" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb50-101"><a href="class-14-hierarchical-models.html#cb50-101" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb50-102"><a href="class-14-hierarchical-models.html#cb50-102" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb50-103"><a href="class-14-hierarchical-models.html#cb50-103" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.082011</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb50-104"><a href="class-14-hierarchical-models.html#cb50-104" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.004559</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb50-105"><a href="class-14-hierarchical-models.html#cb50-105" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.08657</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb50-106"><a href="class-14-hierarchical-models.html#cb50-106" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb50-107"><a href="class-14-hierarchical-models.html#cb50-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-108"><a href="class-14-hierarchical-models.html#cb50-108" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'5d501e12f9a845a1624a7fc2585b1bfe'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb50-109"><a href="class-14-hierarchical-models.html#cb50-109" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb50-110"><a href="class-14-hierarchical-models.html#cb50-110" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">1e-06</span> seconds</span>
<span id="cb50-111"><a href="class-14-hierarchical-models.html#cb50-111" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.01</span> seconds.</span>
<span id="cb50-112"><a href="class-14-hierarchical-models.html#cb50-112" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb50-113"><a href="class-14-hierarchical-models.html#cb50-113" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb50-114"><a href="class-14-hierarchical-models.html#cb50-114" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb50-115"><a href="class-14-hierarchical-models.html#cb50-115" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb50-116"><a href="class-14-hierarchical-models.html#cb50-116" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb50-117"><a href="class-14-hierarchical-models.html#cb50-117" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb50-118"><a href="class-14-hierarchical-models.html#cb50-118" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb50-119"><a href="class-14-hierarchical-models.html#cb50-119" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>  <span class="dv">800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb50-120"><a href="class-14-hierarchical-models.html#cb50-120" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb50-121"><a href="class-14-hierarchical-models.html#cb50-121" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1001</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb50-122"><a href="class-14-hierarchical-models.html#cb50-122" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1200</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb50-123"><a href="class-14-hierarchical-models.html#cb50-123" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1400</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb50-124"><a href="class-14-hierarchical-models.html#cb50-124" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1600</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb50-125"><a href="class-14-hierarchical-models.html#cb50-125" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1800</span> <span class="sc">/</span> <span class="dv">2000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb50-126"><a href="class-14-hierarchical-models.html#cb50-126" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">2000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb50-127"><a href="class-14-hierarchical-models.html#cb50-127" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb50-128"><a href="class-14-hierarchical-models.html#cb50-128" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.112318</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb50-129"><a href="class-14-hierarchical-models.html#cb50-129" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.150898</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb50-130"><a href="class-14-hierarchical-models.html#cb50-130" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.263216</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb50-131"><a href="class-14-hierarchical-models.html#cb50-131" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb50-132"><a href="class-14-hierarchical-models.html#cb50-132" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> There were <span class="dv">1302</span> divergent transitions after warmup. See</span>
<span id="cb50-133"><a href="class-14-hierarchical-models.html#cb50-133" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#divergent-transitions-after-warmup</span></span>
<span id="cb50-134"><a href="class-14-hierarchical-models.html#cb50-134" aria-hidden="true" tabindex="-1"></a>to find out why this is a problem and how to eliminate them.</span>
<span id="cb50-135"><a href="class-14-hierarchical-models.html#cb50-135" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> There were <span class="dv">64</span> transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above <span class="fl">10.</span> See</span>
<span id="cb50-136"><a href="class-14-hierarchical-models.html#cb50-136" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#maximum-treedepth-exceeded</span></span>
<span id="cb50-137"><a href="class-14-hierarchical-models.html#cb50-137" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Examine the <span class="fu">pairs</span>() plot to diagnose sampling problems</span>
<span id="cb50-138"><a href="class-14-hierarchical-models.html#cb50-138" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> The largest R<span class="sc">-</span>hat is <span class="fl">2.48</span>, indicating chains have not mixed.</span>
<span id="cb50-139"><a href="class-14-hierarchical-models.html#cb50-139" aria-hidden="true" tabindex="-1"></a>Running the chains <span class="cf">for</span> more iterations may help. See</span>
<span id="cb50-140"><a href="class-14-hierarchical-models.html#cb50-140" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#r-hat</span></span>
<span id="cb50-141"><a href="class-14-hierarchical-models.html#cb50-141" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Bulk Effective Samples <span class="fu">Size</span> (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span id="cb50-142"><a href="class-14-hierarchical-models.html#cb50-142" aria-hidden="true" tabindex="-1"></a>Running the chains <span class="cf">for</span> more iterations may help. See</span>
<span id="cb50-143"><a href="class-14-hierarchical-models.html#cb50-143" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#bulk-ess</span></span>
<span id="cb50-144"><a href="class-14-hierarchical-models.html#cb50-144" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Tail Effective Samples <span class="fu">Size</span> (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span id="cb50-145"><a href="class-14-hierarchical-models.html#cb50-145" aria-hidden="true" tabindex="-1"></a>Running the chains <span class="cf">for</span> more iterations may help. See</span>
<span id="cb50-146"><a href="class-14-hierarchical-models.html#cb50-146" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#tail-ess</span></span>
<span id="cb50-147"><a href="class-14-hierarchical-models.html#cb50-147" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb50-148"><a href="class-14-hierarchical-models.html#cb50-148" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>summary</span>
<span id="cb50-149"><a href="class-14-hierarchical-models.html#cb50-149" aria-hidden="true" tabindex="-1"></a>                mean      se_mean           sd</span>
<span id="cb50-150"><a href="class-14-hierarchical-models.html#cb50-150" aria-hidden="true" tabindex="-1"></a>mu0    <span class="sc">-</span><span class="fl">6.298275e+08</span> <span class="fl">5.154460e+08</span> <span class="fl">3.117998e+09</span></span>
<span id="cb50-151"><a href="class-14-hierarchical-models.html#cb50-151" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">6.390084e+09</span> <span class="fl">4.044922e+09</span> <span class="fl">5.993897e+10</span></span>
<span id="cb50-152"><a href="class-14-hierarchical-models.html#cb50-152" aria-hidden="true" tabindex="-1"></a>sigma   <span class="fl">3.087602e+00</span> <span class="fl">1.081049e-01</span> <span class="fl">4.432847e-01</span></span>
<span id="cb50-153"><a href="class-14-hierarchical-models.html#cb50-153" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">2.048120e+01</span> <span class="fl">5.157305e-02</span> <span class="fl">8.555959e-01</span></span>
<span id="cb50-154"><a href="class-14-hierarchical-models.html#cb50-154" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]   <span class="fl">2.196264e+01</span> <span class="fl">5.856025e-02</span> <span class="fl">8.566540e-01</span></span>
<span id="cb50-155"><a href="class-14-hierarchical-models.html#cb50-155" aria-hidden="true" tabindex="-1"></a>lp__   <span class="sc">-</span><span class="fl">4.544949e+01</span> <span class="fl">4.382746e+00</span> <span class="fl">6.785962e+00</span></span>
<span id="cb50-156"><a href="class-14-hierarchical-models.html#cb50-156" aria-hidden="true" tabindex="-1"></a>                <span class="fl">2.5</span><span class="sc">%           25%</span>           <span class="dv">50</span>%</span>
<span id="cb50-157"><a href="class-14-hierarchical-models.html#cb50-157" aria-hidden="true" tabindex="-1"></a>mu0    <span class="sc">-</span><span class="fl">1.152481e+10</span> <span class="sc">-</span><span class="fl">6.535645e+05</span>     <span class="sc">-</span><span class="fl">1.192205</span></span>
<span id="cb50-158"><a href="class-14-hierarchical-models.html#cb50-158" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">3.544969e+01</span>  <span class="fl">7.155016e+02</span> <span class="fl">124633.376737</span></span>
<span id="cb50-159"><a href="class-14-hierarchical-models.html#cb50-159" aria-hidden="true" tabindex="-1"></a>sigma   <span class="fl">2.273658e+00</span>  <span class="fl">2.743072e+00</span>      <span class="fl">3.146192</span></span>
<span id="cb50-160"><a href="class-14-hierarchical-models.html#cb50-160" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">1.871180e+01</span>  <span class="fl">2.005002e+01</span>     <span class="fl">20.623289</span></span>
<span id="cb50-161"><a href="class-14-hierarchical-models.html#cb50-161" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]   <span class="fl">1.995763e+01</span>  <span class="fl">2.154988e+01</span>     <span class="fl">22.192814</span></span>
<span id="cb50-162"><a href="class-14-hierarchical-models.html#cb50-162" aria-hidden="true" tabindex="-1"></a>lp__   <span class="sc">-</span><span class="fl">5.799845e+01</span> <span class="sc">-</span><span class="fl">5.099177e+01</span>    <span class="sc">-</span><span class="fl">45.296353</span></span>
<span id="cb50-163"><a href="class-14-hierarchical-models.html#cb50-163" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">75</span><span class="sc">%         97.5%</span>      n_eff     Rhat</span>
<span id="cb50-164"><a href="class-14-hierarchical-models.html#cb50-164" aria-hidden="true" tabindex="-1"></a>mu0     <span class="fl">4.315170e+03</span>  <span class="fl">5.629451e+07</span>  <span class="fl">36.591945</span> <span class="fl">1.089636</span></span>
<span id="cb50-165"><a href="class-14-hierarchical-models.html#cb50-165" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">1.897139e+07</span>  <span class="fl">4.043841e+10</span> <span class="fl">219.582810</span> <span class="fl">1.018855</span></span>
<span id="cb50-166"><a href="class-14-hierarchical-models.html#cb50-166" aria-hidden="true" tabindex="-1"></a>sigma   <span class="fl">3.384626e+00</span>  <span class="fl">3.997700e+00</span>  <span class="fl">16.814149</span> <span class="fl">1.105850</span></span>
<span id="cb50-167"><a href="class-14-hierarchical-models.html#cb50-167" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">2.084043e+01</span>  <span class="fl">2.222828e+01</span> <span class="fl">275.227474</span> <span class="fl">1.014660</span></span>
<span id="cb50-168"><a href="class-14-hierarchical-models.html#cb50-168" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]   <span class="fl">2.234381e+01</span>  <span class="fl">2.357954e+01</span> <span class="fl">213.995673</span> <span class="fl">1.025934</span></span>
<span id="cb50-169"><a href="class-14-hierarchical-models.html#cb50-169" aria-hidden="true" tabindex="-1"></a>lp__   <span class="sc">-</span><span class="fl">3.838686e+01</span> <span class="sc">-</span><span class="fl">3.651638e+01</span>   <span class="fl">2.397344</span> <span class="fl">2.646097</span></span>
<span id="cb50-170"><a href="class-14-hierarchical-models.html#cb50-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-171"><a href="class-14-hierarchical-models.html#cb50-171" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>c_summary</span>
<span id="cb50-172"><a href="class-14-hierarchical-models.html#cb50-172" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">1</span></span>
<span id="cb50-173"><a href="class-14-hierarchical-models.html#cb50-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-174"><a href="class-14-hierarchical-models.html#cb50-174" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-175"><a href="class-14-hierarchical-models.html#cb50-175" aria-hidden="true" tabindex="-1"></a>parameter          mean           sd          <span class="fl">2.5</span>%</span>
<span id="cb50-176"><a href="class-14-hierarchical-models.html#cb50-176" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">1.213868e+05</span> <span class="fl">9.210126e+05</span> <span class="sc">-</span><span class="fl">1.674609e+06</span></span>
<span id="cb50-177"><a href="class-14-hierarchical-models.html#cb50-177" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">3.813515e+06</span> <span class="fl">5.292382e+07</span>  <span class="fl">9.421856e+02</span></span>
<span id="cb50-178"><a href="class-14-hierarchical-models.html#cb50-178" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">2.952402e+00</span> <span class="fl">4.715594e-01</span>  <span class="fl">2.225707e+00</span></span>
<span id="cb50-179"><a href="class-14-hierarchical-models.html#cb50-179" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.040602e+01</span> <span class="fl">9.189164e-01</span>  <span class="fl">1.873646e+01</span></span>
<span id="cb50-180"><a href="class-14-hierarchical-models.html#cb50-180" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.195359e+01</span> <span class="fl">8.537906e-01</span>  <span class="fl">2.028541e+01</span></span>
<span id="cb50-181"><a href="class-14-hierarchical-models.html#cb50-181" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">4.424097e+01</span> <span class="fl">3.123154e+00</span> <span class="sc">-</span><span class="fl">5.101272e+01</span></span>
<span id="cb50-182"><a href="class-14-hierarchical-models.html#cb50-182" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-183"><a href="class-14-hierarchical-models.html#cb50-183" aria-hidden="true" tabindex="-1"></a>parameter          <span class="dv">25</span><span class="sc">%          50%</span>           <span class="dv">75</span>%</span>
<span id="cb50-184"><a href="class-14-hierarchical-models.html#cb50-184" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">18351.84660</span>  <span class="sc">-</span><span class="fl">271.208475</span>   <span class="fl">8203.025695</span></span>
<span id="cb50-185"><a href="class-14-hierarchical-models.html#cb50-185" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">4244.85977</span> <span class="fl">30320.623553</span> <span class="fl">269854.469849</span></span>
<span id="cb50-186"><a href="class-14-hierarchical-models.html#cb50-186" aria-hidden="true" tabindex="-1"></a>   sigma       <span class="fl">2.60069</span>     <span class="fl">2.892375</span>      <span class="fl">3.212148</span></span>
<span id="cb50-187"><a href="class-14-hierarchical-models.html#cb50-187" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]      <span class="fl">19.83466</span>    <span class="fl">20.485363</span>     <span class="fl">20.995128</span></span>
<span id="cb50-188"><a href="class-14-hierarchical-models.html#cb50-188" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]      <span class="fl">21.43133</span>    <span class="fl">21.969827</span>     <span class="fl">22.535255</span></span>
<span id="cb50-189"><a href="class-14-hierarchical-models.html#cb50-189" aria-hidden="true" tabindex="-1"></a>   lp__      <span class="sc">-</span><span class="fl">46.39198</span>   <span class="sc">-</span><span class="fl">43.948390</span>    <span class="sc">-</span><span class="fl">41.564559</span></span>
<span id="cb50-190"><a href="class-14-hierarchical-models.html#cb50-190" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-191"><a href="class-14-hierarchical-models.html#cb50-191" aria-hidden="true" tabindex="-1"></a>parameter         <span class="fl">97.5</span>%</span>
<span id="cb50-192"><a href="class-14-hierarchical-models.html#cb50-192" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">6.085716e+05</span></span>
<span id="cb50-193"><a href="class-14-hierarchical-models.html#cb50-193" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">1.422902e+07</span></span>
<span id="cb50-194"><a href="class-14-hierarchical-models.html#cb50-194" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">4.084910e+00</span></span>
<span id="cb50-195"><a href="class-14-hierarchical-models.html#cb50-195" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.214893e+01</span></span>
<span id="cb50-196"><a href="class-14-hierarchical-models.html#cb50-196" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.351551e+01</span></span>
<span id="cb50-197"><a href="class-14-hierarchical-models.html#cb50-197" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">3.977647e+01</span></span>
<span id="cb50-198"><a href="class-14-hierarchical-models.html#cb50-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-199"><a href="class-14-hierarchical-models.html#cb50-199" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">2</span></span>
<span id="cb50-200"><a href="class-14-hierarchical-models.html#cb50-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-201"><a href="class-14-hierarchical-models.html#cb50-201" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-202"><a href="class-14-hierarchical-models.html#cb50-202" aria-hidden="true" tabindex="-1"></a>parameter          mean           sd          <span class="fl">2.5</span>%</span>
<span id="cb50-203"><a href="class-14-hierarchical-models.html#cb50-203" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">1.268018e+07</span> <span class="fl">3.493743e+07</span> <span class="sc">-</span><span class="fl">1.392716e+08</span></span>
<span id="cb50-204"><a href="class-14-hierarchical-models.html#cb50-204" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">4.736188e+07</span> <span class="fl">1.726830e+08</span>  <span class="fl">9.074468e+03</span></span>
<span id="cb50-205"><a href="class-14-hierarchical-models.html#cb50-205" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">2.981952e+00</span> <span class="fl">4.610764e-01</span>  <span class="fl">2.258058e+00</span></span>
<span id="cb50-206"><a href="class-14-hierarchical-models.html#cb50-206" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.056823e+01</span> <span class="fl">9.609210e-01</span>  <span class="fl">1.876735e+01</span></span>
<span id="cb50-207"><a href="class-14-hierarchical-models.html#cb50-207" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.192077e+01</span> <span class="fl">9.686605e-01</span>  <span class="fl">2.020396e+01</span></span>
<span id="cb50-208"><a href="class-14-hierarchical-models.html#cb50-208" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">4.737915e+01</span> <span class="fl">3.447586e+00</span> <span class="sc">-</span><span class="fl">5.405430e+01</span></span>
<span id="cb50-209"><a href="class-14-hierarchical-models.html#cb50-209" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-210"><a href="class-14-hierarchical-models.html#cb50-210" aria-hidden="true" tabindex="-1"></a>parameter           <span class="dv">25</span><span class="sc">%           50%</span>           <span class="dv">75</span>%</span>
<span id="cb50-211"><a href="class-14-hierarchical-models.html#cb50-211" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">1.481877e+06</span> <span class="sc">-</span><span class="fl">14961.500401</span>  <span class="fl">3.318149e+04</span></span>
<span id="cb50-212"><a href="class-14-hierarchical-models.html#cb50-212" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">5.902920e+04</span> <span class="fl">562467.470259</span>  <span class="fl">1.083412e+07</span></span>
<span id="cb50-213"><a href="class-14-hierarchical-models.html#cb50-213" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">2.653532e+00</span>      <span class="fl">2.915364</span>  <span class="fl">3.263645e+00</span></span>
<span id="cb50-214"><a href="class-14-hierarchical-models.html#cb50-214" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">1.992267e+01</span>     <span class="fl">20.518089</span>  <span class="fl">2.109433e+01</span></span>
<span id="cb50-215"><a href="class-14-hierarchical-models.html#cb50-215" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.124218e+01</span>     <span class="fl">21.915103</span>  <span class="fl">2.256196e+01</span></span>
<span id="cb50-216"><a href="class-14-hierarchical-models.html#cb50-216" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">5.011622e+01</span>    <span class="sc">-</span><span class="fl">46.829884</span> <span class="sc">-</span><span class="fl">4.452419e+01</span></span>
<span id="cb50-217"><a href="class-14-hierarchical-models.html#cb50-217" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-218"><a href="class-14-hierarchical-models.html#cb50-218" aria-hidden="true" tabindex="-1"></a>parameter         <span class="fl">97.5</span>%</span>
<span id="cb50-219"><a href="class-14-hierarchical-models.html#cb50-219" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">3.138132e+06</span></span>
<span id="cb50-220"><a href="class-14-hierarchical-models.html#cb50-220" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">5.139725e+08</span></span>
<span id="cb50-221"><a href="class-14-hierarchical-models.html#cb50-221" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">4.094776e+00</span></span>
<span id="cb50-222"><a href="class-14-hierarchical-models.html#cb50-222" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.255482e+01</span></span>
<span id="cb50-223"><a href="class-14-hierarchical-models.html#cb50-223" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.361500e+01</span></span>
<span id="cb50-224"><a href="class-14-hierarchical-models.html#cb50-224" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">4.216915e+01</span></span>
<span id="cb50-225"><a href="class-14-hierarchical-models.html#cb50-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-226"><a href="class-14-hierarchical-models.html#cb50-226" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">3</span></span>
<span id="cb50-227"><a href="class-14-hierarchical-models.html#cb50-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-228"><a href="class-14-hierarchical-models.html#cb50-228" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-229"><a href="class-14-hierarchical-models.html#cb50-229" aria-hidden="true" tabindex="-1"></a>parameter       mean sd       <span class="fl">2.5</span><span class="sc">%        25%</span>        <span class="dv">50</span>%</span>
<span id="cb50-230"><a href="class-14-hierarchical-models.html#cb50-230" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="sc">-</span><span class="fl">1.192205</span>  <span class="dv">0</span>  <span class="sc">-</span><span class="fl">1.192205</span>  <span class="sc">-</span><span class="fl">1.192205</span>  <span class="sc">-</span><span class="fl">1.192205</span></span>
<span id="cb50-231"><a href="class-14-hierarchical-models.html#cb50-231" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">35.449693</span>  <span class="dv">0</span>  <span class="fl">35.449693</span>  <span class="fl">35.449693</span>  <span class="fl">35.449693</span></span>
<span id="cb50-232"><a href="class-14-hierarchical-models.html#cb50-232" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">3.384626</span>  <span class="dv">0</span>   <span class="fl">3.384626</span>   <span class="fl">3.384626</span>   <span class="fl">3.384626</span></span>
<span id="cb50-233"><a href="class-14-hierarchical-models.html#cb50-233" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.623289</span>  <span class="dv">0</span>  <span class="fl">20.623289</span>  <span class="fl">20.623289</span>  <span class="fl">20.623289</span></span>
<span id="cb50-234"><a href="class-14-hierarchical-models.html#cb50-234" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">22.192814</span>  <span class="dv">0</span>  <span class="fl">22.192814</span>  <span class="fl">22.192814</span>  <span class="fl">22.192814</span></span>
<span id="cb50-235"><a href="class-14-hierarchical-models.html#cb50-235" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">36.516378</span>  <span class="dv">0</span> <span class="sc">-</span><span class="fl">36.516378</span> <span class="sc">-</span><span class="fl">36.516378</span> <span class="sc">-</span><span class="fl">36.516378</span></span>
<span id="cb50-236"><a href="class-14-hierarchical-models.html#cb50-236" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-237"><a href="class-14-hierarchical-models.html#cb50-237" aria-hidden="true" tabindex="-1"></a>parameter        <span class="dv">75</span><span class="sc">%      97.5%</span></span>
<span id="cb50-238"><a href="class-14-hierarchical-models.html#cb50-238" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="sc">-</span><span class="fl">1.192205</span>  <span class="sc">-</span><span class="fl">1.192205</span></span>
<span id="cb50-239"><a href="class-14-hierarchical-models.html#cb50-239" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">35.449693</span>  <span class="fl">35.449693</span></span>
<span id="cb50-240"><a href="class-14-hierarchical-models.html#cb50-240" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">3.384626</span>   <span class="fl">3.384626</span></span>
<span id="cb50-241"><a href="class-14-hierarchical-models.html#cb50-241" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.623289</span>  <span class="fl">20.623289</span></span>
<span id="cb50-242"><a href="class-14-hierarchical-models.html#cb50-242" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">22.192814</span>  <span class="fl">22.192814</span></span>
<span id="cb50-243"><a href="class-14-hierarchical-models.html#cb50-243" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">36.516378</span> <span class="sc">-</span><span class="fl">36.516378</span></span>
<span id="cb50-244"><a href="class-14-hierarchical-models.html#cb50-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-245"><a href="class-14-hierarchical-models.html#cb50-245" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">4</span></span>
<span id="cb50-246"><a href="class-14-hierarchical-models.html#cb50-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-247"><a href="class-14-hierarchical-models.html#cb50-247" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-248"><a href="class-14-hierarchical-models.html#cb50-248" aria-hidden="true" tabindex="-1"></a>parameter          mean           sd          <span class="fl">2.5</span>%</span>
<span id="cb50-249"><a href="class-14-hierarchical-models.html#cb50-249" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">2.506509e+09</span> <span class="fl">5.849352e+09</span> <span class="sc">-</span><span class="fl">2.176912e+10</span></span>
<span id="cb50-250"><a href="class-14-hierarchical-models.html#cb50-250" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">2.550916e+10</span> <span class="fl">1.178711e+11</span>  <span class="fl">2.544016e+06</span></span>
<span id="cb50-251"><a href="class-14-hierarchical-models.html#cb50-251" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">3.031428e+00</span> <span class="fl">4.803075e-01</span>  <span class="fl">2.227762e+00</span></span>
<span id="cb50-252"><a href="class-14-hierarchical-models.html#cb50-252" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.032727e+01</span> <span class="fl">1.051396e+00</span>  <span class="fl">1.839124e+01</span></span>
<span id="cb50-253"><a href="class-14-hierarchical-models.html#cb50-253" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.178341e+01</span> <span class="fl">1.087814e+00</span>  <span class="fl">1.986658e+01</span></span>
<span id="cb50-254"><a href="class-14-hierarchical-models.html#cb50-254" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">5.366145e+01</span> <span class="fl">3.181507e+00</span> <span class="sc">-</span><span class="fl">5.994041e+01</span></span>
<span id="cb50-255"><a href="class-14-hierarchical-models.html#cb50-255" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-256"><a href="class-14-hierarchical-models.html#cb50-256" aria-hidden="true" tabindex="-1"></a>parameter           <span class="dv">25</span><span class="sc">%           50%</span>           <span class="dv">75</span>%</span>
<span id="cb50-257"><a href="class-14-hierarchical-models.html#cb50-257" aria-hidden="true" tabindex="-1"></a>   mu0    <span class="sc">-</span><span class="fl">9.621443e+08</span> <span class="sc">-</span><span class="fl">2.665964e+07</span>  <span class="fl">3.509360e+06</span></span>
<span id="cb50-258"><a href="class-14-hierarchical-models.html#cb50-258" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">2.883706e+07</span>  <span class="fl">2.376446e+08</span>  <span class="fl">4.859333e+09</span></span>
<span id="cb50-259"><a href="class-14-hierarchical-models.html#cb50-259" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">2.676105e+00</span>  <span class="fl">2.975635e+00</span>  <span class="fl">3.380330e+00</span></span>
<span id="cb50-260"><a href="class-14-hierarchical-models.html#cb50-260" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">1.958696e+01</span>  <span class="fl">2.033062e+01</span>  <span class="fl">2.107275e+01</span></span>
<span id="cb50-261"><a href="class-14-hierarchical-models.html#cb50-261" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.103325e+01</span>  <span class="fl">2.185355e+01</span>  <span class="fl">2.253739e+01</span></span>
<span id="cb50-262"><a href="class-14-hierarchical-models.html#cb50-262" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">5.630200e+01</span> <span class="sc">-</span><span class="fl">5.330728e+01</span> <span class="sc">-</span><span class="fl">5.100403e+01</span></span>
<span id="cb50-263"><a href="class-14-hierarchical-models.html#cb50-263" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb50-264"><a href="class-14-hierarchical-models.html#cb50-264" aria-hidden="true" tabindex="-1"></a>parameter         <span class="fl">97.5</span>%</span>
<span id="cb50-265"><a href="class-14-hierarchical-models.html#cb50-265" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">1.176575e+09</span></span>
<span id="cb50-266"><a href="class-14-hierarchical-models.html#cb50-266" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">2.189987e+11</span></span>
<span id="cb50-267"><a href="class-14-hierarchical-models.html#cb50-267" aria-hidden="true" tabindex="-1"></a>   sigma   <span class="fl">4.095057e+00</span></span>
<span id="cb50-268"><a href="class-14-hierarchical-models.html#cb50-268" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">2.229776e+01</span></span>
<span id="cb50-269"><a href="class-14-hierarchical-models.html#cb50-269" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">2.380866e+01</span></span>
<span id="cb50-270"><a href="class-14-hierarchical-models.html#cb50-270" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">4.847898e+01</span></span>
<span id="cb50-271"><a href="class-14-hierarchical-models.html#cb50-271" aria-hidden="true" tabindex="-1"></a><span class="fu">traceplot</span>(fit)</span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode stan"><code class="sourceCode stan"><span id="cb51-1"><a href="class-14-hierarchical-models.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> {</span>
<span id="cb51-2"><a href="class-14-hierarchical-models.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; N;  <span class="co">// number of observations</span></span>
<span id="cb51-3"><a href="class-14-hierarchical-models.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; K;  <span class="co">// number of groups</span></span>
<span id="cb51-4"><a href="class-14-hierarchical-models.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>, <span class="kw">upper</span>=K&gt; group[N];  <span class="co">// group indicator for each observation</span></span>
<span id="cb51-5"><a href="class-14-hierarchical-models.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> y[N];  <span class="co">// observed data</span></span>
<span id="cb51-6"><a href="class-14-hierarchical-models.html#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="class-14-hierarchical-models.html#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="class-14-hierarchical-models.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="kw">parameters</span> {</span>
<span id="cb51-9"><a href="class-14-hierarchical-models.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>,<span class="kw">upper</span>=<span class="dv">50</span>&gt; mu0;             <span class="co">// prior mean for group means</span></span>
<span id="cb51-10"><a href="class-14-hierarchical-models.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">50</span>&gt; sigma0;  <span class="co">// prior std. dev. for group means</span></span>
<span id="cb51-11"><a href="class-14-hierarchical-models.html#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>, <span class="kw">upper</span>=<span class="dv">50</span>&gt; sigma;   <span class="co">// std. dev. of the observations within each group</span></span>
<span id="cb51-12"><a href="class-14-hierarchical-models.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vector</span>[K] mu;          <span class="co">// group means</span></span>
<span id="cb51-13"><a href="class-14-hierarchical-models.html#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="class-14-hierarchical-models.html#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="class-14-hierarchical-models.html#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="kw">model</span> {</span>
<span id="cb51-16"><a href="class-14-hierarchical-models.html#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Priors</span></span>
<span id="cb51-17"><a href="class-14-hierarchical-models.html#cb51-17" aria-hidden="true" tabindex="-1"></a>  mu ~ normal(mu0, sigma0);  <span class="co">// prior for group means</span></span>
<span id="cb51-18"><a href="class-14-hierarchical-models.html#cb51-18" aria-hidden="true" tabindex="-1"></a>  sigma ~ cauchy(<span class="dv">0</span>, <span class="dv">1</span>);      <span class="co">// weakly informative prior for sigma</span></span>
<span id="cb51-19"><a href="class-14-hierarchical-models.html#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="class-14-hierarchical-models.html#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Likelihood</span></span>
<span id="cb51-21"><a href="class-14-hierarchical-models.html#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:N) {</span>
<span id="cb51-22"><a href="class-14-hierarchical-models.html#cb51-22" aria-hidden="true" tabindex="-1"></a>    y[i] ~ normal(mu[group[i]], sigma);</span>
<span id="cb51-23"><a href="class-14-hierarchical-models.html#cb51-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-24"><a href="class-14-hierarchical-models.html#cb51-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="class-14-hierarchical-models.html#cb52-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sampling</span>(hierarchical_model2, <span class="at">data =</span> data_list, <span class="at">chains =</span> <span class="dv">4</span>,<span class="at">iter=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb52-2"><a href="class-14-hierarchical-models.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="class-14-hierarchical-models.html#cb52-3" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'f8f3c9bc4f0327a91fdac658f429e39f'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">1</span>).</span>
<span id="cb52-4"><a href="class-14-hierarchical-models.html#cb52-4" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb52-5"><a href="class-14-hierarchical-models.html#cb52-5" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Gradient evaluation took <span class="fl">9e-06</span> seconds</span>
<span id="cb52-6"><a href="class-14-hierarchical-models.html#cb52-6" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.09</span> seconds.</span>
<span id="cb52-7"><a href="class-14-hierarchical-models.html#cb52-7" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb52-8"><a href="class-14-hierarchical-models.html#cb52-8" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb52-9"><a href="class-14-hierarchical-models.html#cb52-9" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb52-10"><a href="class-14-hierarchical-models.html#cb52-10" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb52-11"><a href="class-14-hierarchical-models.html#cb52-11" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb52-12"><a href="class-14-hierarchical-models.html#cb52-12" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb52-13"><a href="class-14-hierarchical-models.html#cb52-13" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">3000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb52-14"><a href="class-14-hierarchical-models.html#cb52-14" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">4000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb52-15"><a href="class-14-hierarchical-models.html#cb52-15" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb52-16"><a href="class-14-hierarchical-models.html#cb52-16" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5001</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb52-17"><a href="class-14-hierarchical-models.html#cb52-17" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">6000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb52-18"><a href="class-14-hierarchical-models.html#cb52-18" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">7000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb52-19"><a href="class-14-hierarchical-models.html#cb52-19" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">8000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb52-20"><a href="class-14-hierarchical-models.html#cb52-20" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">9000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb52-21"><a href="class-14-hierarchical-models.html#cb52-21" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">10000</span> <span class="sc">/</span> <span class="dv">10000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb52-22"><a href="class-14-hierarchical-models.html#cb52-22" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb52-23"><a href="class-14-hierarchical-models.html#cb52-23" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.15204</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb52-24"><a href="class-14-hierarchical-models.html#cb52-24" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.119692</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb52-25"><a href="class-14-hierarchical-models.html#cb52-25" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span>                <span class="fl">0.271732</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb52-26"><a href="class-14-hierarchical-models.html#cb52-26" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">1</span><span class="sc">:</span> </span>
<span id="cb52-27"><a href="class-14-hierarchical-models.html#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="class-14-hierarchical-models.html#cb52-28" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'f8f3c9bc4f0327a91fdac658f429e39f'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">2</span>).</span>
<span id="cb52-29"><a href="class-14-hierarchical-models.html#cb52-29" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb52-30"><a href="class-14-hierarchical-models.html#cb52-30" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Gradient evaluation took <span class="fl">3e-06</span> seconds</span>
<span id="cb52-31"><a href="class-14-hierarchical-models.html#cb52-31" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.03</span> seconds.</span>
<span id="cb52-32"><a href="class-14-hierarchical-models.html#cb52-32" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb52-33"><a href="class-14-hierarchical-models.html#cb52-33" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb52-34"><a href="class-14-hierarchical-models.html#cb52-34" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb52-35"><a href="class-14-hierarchical-models.html#cb52-35" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb52-36"><a href="class-14-hierarchical-models.html#cb52-36" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb52-37"><a href="class-14-hierarchical-models.html#cb52-37" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb52-38"><a href="class-14-hierarchical-models.html#cb52-38" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">3000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb52-39"><a href="class-14-hierarchical-models.html#cb52-39" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">4000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb52-40"><a href="class-14-hierarchical-models.html#cb52-40" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb52-41"><a href="class-14-hierarchical-models.html#cb52-41" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5001</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb52-42"><a href="class-14-hierarchical-models.html#cb52-42" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">6000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb52-43"><a href="class-14-hierarchical-models.html#cb52-43" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">7000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb52-44"><a href="class-14-hierarchical-models.html#cb52-44" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">8000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb52-45"><a href="class-14-hierarchical-models.html#cb52-45" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">9000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb52-46"><a href="class-14-hierarchical-models.html#cb52-46" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">10000</span> <span class="sc">/</span> <span class="dv">10000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb52-47"><a href="class-14-hierarchical-models.html#cb52-47" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb52-48"><a href="class-14-hierarchical-models.html#cb52-48" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.142322</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb52-49"><a href="class-14-hierarchical-models.html#cb52-49" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.151231</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb52-50"><a href="class-14-hierarchical-models.html#cb52-50" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span>                <span class="fl">0.293553</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb52-51"><a href="class-14-hierarchical-models.html#cb52-51" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">2</span><span class="sc">:</span> </span>
<span id="cb52-52"><a href="class-14-hierarchical-models.html#cb52-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-53"><a href="class-14-hierarchical-models.html#cb52-53" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'f8f3c9bc4f0327a91fdac658f429e39f'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">3</span>).</span>
<span id="cb52-54"><a href="class-14-hierarchical-models.html#cb52-54" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb52-55"><a href="class-14-hierarchical-models.html#cb52-55" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Gradient evaluation took <span class="fl">4e-06</span> seconds</span>
<span id="cb52-56"><a href="class-14-hierarchical-models.html#cb52-56" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.04</span> seconds.</span>
<span id="cb52-57"><a href="class-14-hierarchical-models.html#cb52-57" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb52-58"><a href="class-14-hierarchical-models.html#cb52-58" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb52-59"><a href="class-14-hierarchical-models.html#cb52-59" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb52-60"><a href="class-14-hierarchical-models.html#cb52-60" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb52-61"><a href="class-14-hierarchical-models.html#cb52-61" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb52-62"><a href="class-14-hierarchical-models.html#cb52-62" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb52-63"><a href="class-14-hierarchical-models.html#cb52-63" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">3000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb52-64"><a href="class-14-hierarchical-models.html#cb52-64" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">4000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb52-65"><a href="class-14-hierarchical-models.html#cb52-65" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb52-66"><a href="class-14-hierarchical-models.html#cb52-66" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5001</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb52-67"><a href="class-14-hierarchical-models.html#cb52-67" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">6000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb52-68"><a href="class-14-hierarchical-models.html#cb52-68" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">7000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb52-69"><a href="class-14-hierarchical-models.html#cb52-69" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">8000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb52-70"><a href="class-14-hierarchical-models.html#cb52-70" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">9000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb52-71"><a href="class-14-hierarchical-models.html#cb52-71" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">10000</span> <span class="sc">/</span> <span class="dv">10000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb52-72"><a href="class-14-hierarchical-models.html#cb52-72" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb52-73"><a href="class-14-hierarchical-models.html#cb52-73" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.149872</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb52-74"><a href="class-14-hierarchical-models.html#cb52-74" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.095246</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb52-75"><a href="class-14-hierarchical-models.html#cb52-75" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span>                <span class="fl">0.245118</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb52-76"><a href="class-14-hierarchical-models.html#cb52-76" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">3</span><span class="sc">:</span> </span>
<span id="cb52-77"><a href="class-14-hierarchical-models.html#cb52-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-78"><a href="class-14-hierarchical-models.html#cb52-78" aria-hidden="true" tabindex="-1"></a>SAMPLING FOR MODEL <span class="st">'f8f3c9bc4f0327a91fdac658f429e39f'</span> <span class="fu">NOW</span> (CHAIN <span class="dv">4</span>).</span>
<span id="cb52-79"><a href="class-14-hierarchical-models.html#cb52-79" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb52-80"><a href="class-14-hierarchical-models.html#cb52-80" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Gradient evaluation took <span class="fl">4e-06</span> seconds</span>
<span id="cb52-81"><a href="class-14-hierarchical-models.html#cb52-81" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> <span class="dv">1000</span> transitions using <span class="dv">10</span> leapfrog steps per transition would take <span class="fl">0.04</span> seconds.</span>
<span id="cb52-82"><a href="class-14-hierarchical-models.html#cb52-82" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Adjust your expectations accordingly<span class="sc">!</span></span>
<span id="cb52-83"><a href="class-14-hierarchical-models.html#cb52-83" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb52-84"><a href="class-14-hierarchical-models.html#cb52-84" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb52-85"><a href="class-14-hierarchical-models.html#cb52-85" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span>    <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10000</span> [  <span class="dv">0</span>%]  (Warmup)</span>
<span id="cb52-86"><a href="class-14-hierarchical-models.html#cb52-86" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">1000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">10</span>%]  (Warmup)</span>
<span id="cb52-87"><a href="class-14-hierarchical-models.html#cb52-87" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">2000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">20</span>%]  (Warmup)</span>
<span id="cb52-88"><a href="class-14-hierarchical-models.html#cb52-88" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">3000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">30</span>%]  (Warmup)</span>
<span id="cb52-89"><a href="class-14-hierarchical-models.html#cb52-89" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">4000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">40</span>%]  (Warmup)</span>
<span id="cb52-90"><a href="class-14-hierarchical-models.html#cb52-90" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Warmup)</span>
<span id="cb52-91"><a href="class-14-hierarchical-models.html#cb52-91" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">5001</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">50</span>%]  (Sampling)</span>
<span id="cb52-92"><a href="class-14-hierarchical-models.html#cb52-92" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">6000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">60</span>%]  (Sampling)</span>
<span id="cb52-93"><a href="class-14-hierarchical-models.html#cb52-93" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">7000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">70</span>%]  (Sampling)</span>
<span id="cb52-94"><a href="class-14-hierarchical-models.html#cb52-94" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">8000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">80</span>%]  (Sampling)</span>
<span id="cb52-95"><a href="class-14-hierarchical-models.html#cb52-95" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">9000</span> <span class="sc">/</span> <span class="dv">10000</span> [ <span class="dv">90</span>%]  (Sampling)</span>
<span id="cb52-96"><a href="class-14-hierarchical-models.html#cb52-96" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> Iteration<span class="sc">:</span> <span class="dv">10000</span> <span class="sc">/</span> <span class="dv">10000</span> [<span class="dv">100</span>%]  (Sampling)</span>
<span id="cb52-97"><a href="class-14-hierarchical-models.html#cb52-97" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb52-98"><a href="class-14-hierarchical-models.html#cb52-98" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>  Elapsed Time<span class="sc">:</span> <span class="fl">0.150819</span> <span class="fu">seconds</span> (Warm<span class="sc">-</span>up)</span>
<span id="cb52-99"><a href="class-14-hierarchical-models.html#cb52-99" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.103341</span> <span class="fu">seconds</span> (Sampling)</span>
<span id="cb52-100"><a href="class-14-hierarchical-models.html#cb52-100" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span>                <span class="fl">0.25416</span> <span class="fu">seconds</span> (Total)</span>
<span id="cb52-101"><a href="class-14-hierarchical-models.html#cb52-101" aria-hidden="true" tabindex="-1"></a>Chain <span class="dv">4</span><span class="sc">:</span> </span>
<span id="cb52-102"><a href="class-14-hierarchical-models.html#cb52-102" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> There were <span class="dv">2526</span> divergent transitions after warmup. See</span>
<span id="cb52-103"><a href="class-14-hierarchical-models.html#cb52-103" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#divergent-transitions-after-warmup</span></span>
<span id="cb52-104"><a href="class-14-hierarchical-models.html#cb52-104" aria-hidden="true" tabindex="-1"></a>to find out why this is a problem and how to eliminate them.</span>
<span id="cb52-105"><a href="class-14-hierarchical-models.html#cb52-105" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Examine the <span class="fu">pairs</span>() plot to diagnose sampling problems</span>
<span id="cb52-106"><a href="class-14-hierarchical-models.html#cb52-106" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Bulk Effective Samples <span class="fu">Size</span> (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span id="cb52-107"><a href="class-14-hierarchical-models.html#cb52-107" aria-hidden="true" tabindex="-1"></a>Running the chains <span class="cf">for</span> more iterations may help. See</span>
<span id="cb52-108"><a href="class-14-hierarchical-models.html#cb52-108" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#bulk-ess</span></span>
<span id="cb52-109"><a href="class-14-hierarchical-models.html#cb52-109" aria-hidden="true" tabindex="-1"></a>Warning<span class="sc">:</span> Tail Effective Samples <span class="fu">Size</span> (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span id="cb52-110"><a href="class-14-hierarchical-models.html#cb52-110" aria-hidden="true" tabindex="-1"></a>Running the chains <span class="cf">for</span> more iterations may help. See</span>
<span id="cb52-111"><a href="class-14-hierarchical-models.html#cb52-111" aria-hidden="true" tabindex="-1"></a>https<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#tail-ess</span></span>
<span id="cb52-112"><a href="class-14-hierarchical-models.html#cb52-112" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb52-113"><a href="class-14-hierarchical-models.html#cb52-113" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>summary</span>
<span id="cb52-114"><a href="class-14-hierarchical-models.html#cb52-114" aria-hidden="true" tabindex="-1"></a>             mean    se_mean         sd        <span class="fl">2.5</span>%</span>
<span id="cb52-115"><a href="class-14-hierarchical-models.html#cb52-115" aria-hidden="true" tabindex="-1"></a>mu0     <span class="fl">21.773695</span> <span class="fl">0.09497232</span>  <span class="fl">7.5546068</span>   <span class="fl">4.8999552</span></span>
<span id="cb52-116"><a href="class-14-hierarchical-models.html#cb52-116" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">10.815775</span> <span class="fl">0.36591543</span> <span class="fl">11.5133056</span>   <span class="fl">0.5344468</span></span>
<span id="cb52-117"><a href="class-14-hierarchical-models.html#cb52-117" aria-hidden="true" tabindex="-1"></a>sigma    <span class="fl">3.017601</span> <span class="fl">0.01841037</span>  <span class="fl">0.5128860</span>   <span class="fl">2.2135085</span></span>
<span id="cb52-118"><a href="class-14-hierarchical-models.html#cb52-118" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">20.624575</span> <span class="fl">0.03662711</span>  <span class="fl">0.9693533</span>  <span class="fl">18.7369353</span></span>
<span id="cb52-119"><a href="class-14-hierarchical-models.html#cb52-119" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]   <span class="fl">21.957983</span> <span class="fl">0.01781672</span>  <span class="fl">0.9020157</span>  <span class="fl">20.1646034</span></span>
<span id="cb52-120"><a href="class-14-hierarchical-models.html#cb52-120" aria-hidden="true" tabindex="-1"></a>lp__   <span class="sc">-</span><span class="fl">33.590058</span> <span class="fl">0.07062162</span>  <span class="fl">2.2308671</span> <span class="sc">-</span><span class="fl">38.7741984</span></span>
<span id="cb52-121"><a href="class-14-hierarchical-models.html#cb52-121" aria-hidden="true" tabindex="-1"></a>              <span class="dv">25</span><span class="sc">%        50%</span>        <span class="dv">75</span><span class="sc">%      97.5%</span></span>
<span id="cb52-122"><a href="class-14-hierarchical-models.html#cb52-122" aria-hidden="true" tabindex="-1"></a>mu0     <span class="fl">18.998751</span>  <span class="fl">21.491047</span>  <span class="fl">23.846708</span>  <span class="fl">41.737520</span></span>
<span id="cb52-123"><a href="class-14-hierarchical-models.html#cb52-123" aria-hidden="true" tabindex="-1"></a>sigma0   <span class="fl">2.190631</span>   <span class="fl">6.135375</span>  <span class="fl">15.752049</span>  <span class="fl">42.555142</span></span>
<span id="cb52-124"><a href="class-14-hierarchical-models.html#cb52-124" aria-hidden="true" tabindex="-1"></a>sigma    <span class="fl">2.649268</span>   <span class="fl">2.947385</span>   <span class="fl">3.305782</span>   <span class="fl">4.205829</span></span>
<span id="cb52-125"><a href="class-14-hierarchical-models.html#cb52-125" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">19.984954</span>  <span class="fl">20.613969</span>  <span class="fl">21.236954</span>  <span class="fl">22.551863</span></span>
<span id="cb52-126"><a href="class-14-hierarchical-models.html#cb52-126" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]   <span class="fl">21.386678</span>  <span class="fl">21.977338</span>  <span class="fl">22.517775</span>  <span class="fl">23.761531</span></span>
<span id="cb52-127"><a href="class-14-hierarchical-models.html#cb52-127" aria-hidden="true" tabindex="-1"></a>lp__   <span class="sc">-</span><span class="fl">34.877170</span> <span class="sc">-</span><span class="fl">33.247763</span> <span class="sc">-</span><span class="fl">31.979781</span> <span class="sc">-</span><span class="fl">30.185604</span></span>
<span id="cb52-128"><a href="class-14-hierarchical-models.html#cb52-128" aria-hidden="true" tabindex="-1"></a>           n_eff     Rhat</span>
<span id="cb52-129"><a href="class-14-hierarchical-models.html#cb52-129" aria-hidden="true" tabindex="-1"></a>mu0    <span class="fl">6327.4634</span> <span class="fl">1.000883</span></span>
<span id="cb52-130"><a href="class-14-hierarchical-models.html#cb52-130" aria-hidden="true" tabindex="-1"></a>sigma0  <span class="fl">990.0078</span> <span class="fl">1.003645</span></span>
<span id="cb52-131"><a href="class-14-hierarchical-models.html#cb52-131" aria-hidden="true" tabindex="-1"></a>sigma   <span class="fl">776.0979</span> <span class="fl">1.007411</span></span>
<span id="cb52-132"><a href="class-14-hierarchical-models.html#cb52-132" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">1</span>]   <span class="fl">700.4205</span> <span class="fl">1.004426</span></span>
<span id="cb52-133"><a href="class-14-hierarchical-models.html#cb52-133" aria-hidden="true" tabindex="-1"></a>mu[<span class="dv">2</span>]  <span class="fl">2563.1425</span> <span class="fl">1.001500</span></span>
<span id="cb52-134"><a href="class-14-hierarchical-models.html#cb52-134" aria-hidden="true" tabindex="-1"></a>lp__    <span class="fl">997.8654</span> <span class="fl">1.002470</span></span>
<span id="cb52-135"><a href="class-14-hierarchical-models.html#cb52-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-136"><a href="class-14-hierarchical-models.html#cb52-136" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>c_summary</span>
<span id="cb52-137"><a href="class-14-hierarchical-models.html#cb52-137" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">1</span></span>
<span id="cb52-138"><a href="class-14-hierarchical-models.html#cb52-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-139"><a href="class-14-hierarchical-models.html#cb52-139" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-140"><a href="class-14-hierarchical-models.html#cb52-140" aria-hidden="true" tabindex="-1"></a>parameter       mean         sd        <span class="fl">2.5</span><span class="sc">%        25%</span></span>
<span id="cb52-141"><a href="class-14-hierarchical-models.html#cb52-141" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.727405</span>  <span class="fl">7.9922762</span>   <span class="fl">3.8346407</span>  <span class="fl">18.658644</span></span>
<span id="cb52-142"><a href="class-14-hierarchical-models.html#cb52-142" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">11.492980</span> <span class="fl">11.7297399</span>   <span class="fl">0.8567078</span>   <span class="fl">2.595123</span></span>
<span id="cb52-143"><a href="class-14-hierarchical-models.html#cb52-143" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">2.979427</span>  <span class="fl">0.4848784</span>   <span class="fl">2.1882941</span>   <span class="fl">2.621831</span></span>
<span id="cb52-144"><a href="class-14-hierarchical-models.html#cb52-144" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.588932</span>  <span class="fl">0.9069508</span>  <span class="fl">18.7952755</span>  <span class="fl">19.965409</span></span>
<span id="cb52-145"><a href="class-14-hierarchical-models.html#cb52-145" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.974154</span>  <span class="fl">0.9031054</span>  <span class="fl">20.1839491</span>  <span class="fl">21.380328</span></span>
<span id="cb52-146"><a href="class-14-hierarchical-models.html#cb52-146" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.707282</span>  <span class="fl">2.1519217</span> <span class="sc">-</span><span class="fl">38.7377612</span> <span class="sc">-</span><span class="fl">34.940295</span></span>
<span id="cb52-147"><a href="class-14-hierarchical-models.html#cb52-147" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-148"><a href="class-14-hierarchical-models.html#cb52-148" aria-hidden="true" tabindex="-1"></a>parameter        <span class="dv">50</span><span class="sc">%        75%</span>     <span class="fl">97.5</span>%</span>
<span id="cb52-149"><a href="class-14-hierarchical-models.html#cb52-149" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.463673</span>  <span class="fl">24.202531</span>  <span class="fl">42.03364</span></span>
<span id="cb52-150"><a href="class-14-hierarchical-models.html#cb52-150" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">6.770633</span>  <span class="fl">16.581002</span>  <span class="fl">42.96402</span></span>
<span id="cb52-151"><a href="class-14-hierarchical-models.html#cb52-151" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">2.939741</span>   <span class="fl">3.252348</span>   <span class="fl">4.06832</span></span>
<span id="cb52-152"><a href="class-14-hierarchical-models.html#cb52-152" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.623819</span>  <span class="fl">21.181776</span>  <span class="fl">22.41359</span></span>
<span id="cb52-153"><a href="class-14-hierarchical-models.html#cb52-153" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">22.016767</span>  <span class="fl">22.541591</span>  <span class="fl">23.78466</span></span>
<span id="cb52-154"><a href="class-14-hierarchical-models.html#cb52-154" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.395637</span> <span class="sc">-</span><span class="fl">32.159178</span> <span class="sc">-</span><span class="fl">30.47163</span></span>
<span id="cb52-155"><a href="class-14-hierarchical-models.html#cb52-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-156"><a href="class-14-hierarchical-models.html#cb52-156" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">2</span></span>
<span id="cb52-157"><a href="class-14-hierarchical-models.html#cb52-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-158"><a href="class-14-hierarchical-models.html#cb52-158" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-159"><a href="class-14-hierarchical-models.html#cb52-159" aria-hidden="true" tabindex="-1"></a>parameter       mean         sd        <span class="fl">2.5</span><span class="sc">%        25%</span></span>
<span id="cb52-160"><a href="class-14-hierarchical-models.html#cb52-160" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.335605</span>  <span class="fl">6.8877365</span>   <span class="fl">4.9226480</span>  <span class="fl">19.352565</span></span>
<span id="cb52-161"><a href="class-14-hierarchical-models.html#cb52-161" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">9.383172</span> <span class="fl">11.0554807</span>   <span class="fl">0.4685313</span>   <span class="fl">1.363844</span></span>
<span id="cb52-162"><a href="class-14-hierarchical-models.html#cb52-162" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">3.113694</span>  <span class="fl">0.5599424</span>   <span class="fl">2.2317992</span>   <span class="fl">2.690882</span></span>
<span id="cb52-163"><a href="class-14-hierarchical-models.html#cb52-163" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.751269</span>  <span class="fl">1.0098162</span>  <span class="fl">18.7262477</span>  <span class="fl">20.064624</span></span>
<span id="cb52-164"><a href="class-14-hierarchical-models.html#cb52-164" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.925538</span>  <span class="fl">0.8492426</span>  <span class="fl">20.1407228</span>  <span class="fl">21.389642</span></span>
<span id="cb52-165"><a href="class-14-hierarchical-models.html#cb52-165" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.385787</span>  <span class="fl">2.1960102</span> <span class="sc">-</span><span class="fl">38.6258793</span> <span class="sc">-</span><span class="fl">34.598588</span></span>
<span id="cb52-166"><a href="class-14-hierarchical-models.html#cb52-166" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-167"><a href="class-14-hierarchical-models.html#cb52-167" aria-hidden="true" tabindex="-1"></a>parameter       <span class="dv">50</span><span class="sc">%        75%</span>      <span class="fl">97.5</span>%</span>
<span id="cb52-168"><a href="class-14-hierarchical-models.html#cb52-168" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.49134</span>  <span class="fl">23.026155</span>  <span class="fl">38.625201</span></span>
<span id="cb52-169"><a href="class-14-hierarchical-models.html#cb52-169" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">4.54318</span>  <span class="fl">13.603022</span>  <span class="fl">40.881743</span></span>
<span id="cb52-170"><a href="class-14-hierarchical-models.html#cb52-170" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">3.04412</span>   <span class="fl">3.485659</span>   <span class="fl">4.314664</span></span>
<span id="cb52-171"><a href="class-14-hierarchical-models.html#cb52-171" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.76885</span>  <span class="fl">21.561221</span>  <span class="fl">22.551863</span></span>
<span id="cb52-172"><a href="class-14-hierarchical-models.html#cb52-172" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.90414</span>  <span class="fl">22.421286</span>  <span class="fl">23.609226</span></span>
<span id="cb52-173"><a href="class-14-hierarchical-models.html#cb52-173" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">32.98935</span> <span class="sc">-</span><span class="fl">31.862509</span> <span class="sc">-</span><span class="fl">30.043203</span></span>
<span id="cb52-174"><a href="class-14-hierarchical-models.html#cb52-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-175"><a href="class-14-hierarchical-models.html#cb52-175" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">3</span></span>
<span id="cb52-176"><a href="class-14-hierarchical-models.html#cb52-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-177"><a href="class-14-hierarchical-models.html#cb52-177" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-178"><a href="class-14-hierarchical-models.html#cb52-178" aria-hidden="true" tabindex="-1"></a>parameter       mean         sd       <span class="fl">2.5</span><span class="sc">%        25%</span></span>
<span id="cb52-179"><a href="class-14-hierarchical-models.html#cb52-179" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">22.084594</span>  <span class="fl">7.8415662</span>   <span class="fl">5.854910</span>  <span class="fl">18.882704</span></span>
<span id="cb52-180"><a href="class-14-hierarchical-models.html#cb52-180" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">11.647049</span> <span class="fl">11.6854851</span>   <span class="fl">0.806815</span>   <span class="fl">2.770359</span></span>
<span id="cb52-181"><a href="class-14-hierarchical-models.html#cb52-181" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">3.007342</span>  <span class="fl">0.5017635</span>   <span class="fl">2.213511</span>   <span class="fl">2.664547</span></span>
<span id="cb52-182"><a href="class-14-hierarchical-models.html#cb52-182" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.589152</span>  <span class="fl">0.9653974</span>  <span class="fl">18.690434</span>  <span class="fl">19.965053</span></span>
<span id="cb52-183"><a href="class-14-hierarchical-models.html#cb52-183" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.954102</span>  <span class="fl">0.9571700</span>  <span class="fl">20.093463</span>  <span class="fl">21.338937</span></span>
<span id="cb52-184"><a href="class-14-hierarchical-models.html#cb52-184" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.741462</span>  <span class="fl">2.2886064</span> <span class="sc">-</span><span class="fl">39.017297</span> <span class="sc">-</span><span class="fl">35.031404</span></span>
<span id="cb52-185"><a href="class-14-hierarchical-models.html#cb52-185" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-186"><a href="class-14-hierarchical-models.html#cb52-186" aria-hidden="true" tabindex="-1"></a>parameter        <span class="dv">50</span><span class="sc">%        75%</span>      <span class="fl">97.5</span>%</span>
<span id="cb52-187"><a href="class-14-hierarchical-models.html#cb52-187" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.318323</span>  <span class="fl">24.516808</span>  <span class="fl">42.910231</span></span>
<span id="cb52-188"><a href="class-14-hierarchical-models.html#cb52-188" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">7.140857</span>  <span class="fl">16.752785</span>  <span class="fl">43.725270</span></span>
<span id="cb52-189"><a href="class-14-hierarchical-models.html#cb52-189" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">2.944843</span>   <span class="fl">3.276736</span>   <span class="fl">4.168438</span></span>
<span id="cb52-190"><a href="class-14-hierarchical-models.html#cb52-190" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.584467</span>  <span class="fl">21.181845</span>  <span class="fl">22.644822</span></span>
<span id="cb52-191"><a href="class-14-hierarchical-models.html#cb52-191" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.935781</span>  <span class="fl">22.565154</span>  <span class="fl">23.829529</span></span>
<span id="cb52-192"><a href="class-14-hierarchical-models.html#cb52-192" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.428621</span> <span class="sc">-</span><span class="fl">32.161115</span> <span class="sc">-</span><span class="fl">30.251195</span></span>
<span id="cb52-193"><a href="class-14-hierarchical-models.html#cb52-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-194"><a href="class-14-hierarchical-models.html#cb52-194" aria-hidden="true" tabindex="-1"></a>, , chains <span class="ot">=</span> chain<span class="sc">:</span><span class="dv">4</span></span>
<span id="cb52-195"><a href="class-14-hierarchical-models.html#cb52-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-196"><a href="class-14-hierarchical-models.html#cb52-196" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-197"><a href="class-14-hierarchical-models.html#cb52-197" aria-hidden="true" tabindex="-1"></a>parameter       mean         sd        <span class="fl">2.5</span><span class="sc">%       25%</span></span>
<span id="cb52-198"><a href="class-14-hierarchical-models.html#cb52-198" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.947176</span>  <span class="fl">7.4292764</span>   <span class="fl">5.6138259</span>  <span class="fl">19.07052</span></span>
<span id="cb52-199"><a href="class-14-hierarchical-models.html#cb52-199" aria-hidden="true" tabindex="-1"></a>   sigma0  <span class="fl">10.739898</span> <span class="fl">11.4339401</span>   <span class="fl">0.4733902</span>   <span class="fl">2.15118</span></span>
<span id="cb52-200"><a href="class-14-hierarchical-models.html#cb52-200" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">2.969942</span>  <span class="fl">0.4887603</span>   <span class="fl">2.2110951</span>   <span class="fl">2.62075</span></span>
<span id="cb52-201"><a href="class-14-hierarchical-models.html#cb52-201" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.568946</span>  <span class="fl">0.9814230</span>  <span class="fl">18.7105793</span>  <span class="fl">19.96346</span></span>
<span id="cb52-202"><a href="class-14-hierarchical-models.html#cb52-202" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">21.978139</span>  <span class="fl">0.8945921</span>  <span class="fl">20.2537256</span>  <span class="fl">21.41498</span></span>
<span id="cb52-203"><a href="class-14-hierarchical-models.html#cb52-203" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.525700</span>  <span class="fl">2.2663982</span> <span class="sc">-</span><span class="fl">38.6989426</span> <span class="sc">-</span><span class="fl">34.87816</span></span>
<span id="cb52-204"><a href="class-14-hierarchical-models.html#cb52-204" aria-hidden="true" tabindex="-1"></a>         stats</span>
<span id="cb52-205"><a href="class-14-hierarchical-models.html#cb52-205" aria-hidden="true" tabindex="-1"></a>parameter        <span class="dv">50</span><span class="sc">%        75%</span>      <span class="fl">97.5</span>%</span>
<span id="cb52-206"><a href="class-14-hierarchical-models.html#cb52-206" aria-hidden="true" tabindex="-1"></a>   mu0     <span class="fl">21.637459</span>  <span class="fl">23.823351</span>  <span class="fl">41.892832</span></span>
<span id="cb52-207"><a href="class-14-hierarchical-models.html#cb52-207" aria-hidden="true" tabindex="-1"></a>   sigma0   <span class="fl">6.034383</span>  <span class="fl">15.739733</span>  <span class="fl">42.186837</span></span>
<span id="cb52-208"><a href="class-14-hierarchical-models.html#cb52-208" aria-hidden="true" tabindex="-1"></a>   sigma    <span class="fl">2.891319</span>   <span class="fl">3.227012</span>   <span class="fl">4.104068</span></span>
<span id="cb52-209"><a href="class-14-hierarchical-models.html#cb52-209" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">1</span>]   <span class="fl">20.524350</span>  <span class="fl">21.126342</span>  <span class="fl">22.541343</span></span>
<span id="cb52-210"><a href="class-14-hierarchical-models.html#cb52-210" aria-hidden="true" tabindex="-1"></a>   mu[<span class="dv">2</span>]   <span class="fl">22.049839</span>  <span class="fl">22.527354</span>  <span class="fl">23.820328</span></span>
<span id="cb52-211"><a href="class-14-hierarchical-models.html#cb52-211" aria-hidden="true" tabindex="-1"></a>   lp__   <span class="sc">-</span><span class="fl">33.186071</span> <span class="sc">-</span><span class="fl">31.904034</span> <span class="sc">-</span><span class="fl">30.160351</span></span>
<span id="cb52-212"><a href="class-14-hierarchical-models.html#cb52-212" aria-hidden="true" tabindex="-1"></a><span class="fu">traceplot</span>(fit)</span></code></pre></div>
<div class="inline-figure"><img src="14_files/figure-html/unnamed-chunk-18-1.png" width="672"></div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="class-13-information-theory-cont.html"><span class="header-section-number">13</span> Class 13: Information Theory (cont)</a></div>
<div class="next"><a href="to-be-incorporated.html"><span class="header-section-number">15</span> To Be Incorporated</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#class-14-hierarchical-models"><span class="header-section-number">14</span> Class 14: Hierarchical Models</a></li>
<li>
<a class="nav-link" href="#example-1-bristol-babies"><span class="header-section-number">14.1</span> Example 1: Bristol babies</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#constant-risk-model"><span class="header-section-number">14.1.1</span> Constant-risk model</a></li>
<li><a class="nav-link" href="#independent-parameters-model"><span class="header-section-number">14.1.2</span> Independent-parameters model</a></li>
<li><a class="nav-link" href="#hierarchical-model"><span class="header-section-number">14.1.3</span> Hierarchical model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#example-2-james-stein-baseball"><span class="header-section-number">14.2</span> Example 2: James-Stein Baseball</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#complete-pooling"><span class="header-section-number">14.2.1</span> Complete pooling</a></li>
<li><a class="nav-link" href="#no-pooling"><span class="header-section-number">14.2.2</span> No pooling</a></li>
<li><a class="nav-link" href="#partial-pooling"><span class="header-section-number">14.2.3</span> Partial pooling</a></li>
<li><a class="nav-link" href="#observed-vs-estimated"><span class="header-section-number">14.2.4</span> Observed vs estimated</a></li>
</ul>
</li>
<li><a class="nav-link" href="#example-3-chatgpt"><span class="header-section-number">14.3</span> Example 3: ChatGPT</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/arthurberg/Bayesian/blob/main/14.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/arthurberg/Bayesian/edit/main/14.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PHS 528: Bayesian Methods</strong>" was written by Arthur Berg. It was last built on 2023-02-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
